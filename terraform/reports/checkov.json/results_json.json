{"check_type": "terraform", "results": {"passed_checks": [{"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[1, "resource \"aws_iam_role\" \"ebs_role\" {\n"], [2, "  name = \"ebs_role\"\n"], [3, "\n"], [4, "\n"], [5, "  assume_role_policy = jsonencode({\n"], [6, "    Version = \"2012-10-17\"\n"], [7, "    Statement = [\n"], [8, "      {\n"], [9, "        Action = [\n"], [10, "          \"sts:AssumeRole\",\n"], [11, "          \"sts:TagSession\"\n"], [12, "        ]\n"], [13, "        Effect = \"Allow\"\n"], [14, "        Sid    = \"\"\n"], [15, "        Principal = {\n"], [16, "          Service = \"pods.eks.amazonaws.com\"\n"], [17, "        }\n"], [18, "      },\n"], [19, "    ]\n"], [20, "  })\n"], [21, "\n"], [22, "\n"], [23, "}\n"]], "file_path": "/EBS-IAM.tf", "file_abs_path": "/tf/EBS-IAM.tf", "repo_file_path": "/tf/EBS-IAM.tf", "file_line_range": [1, 23], "resource": "aws_iam_role.ebs_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44", "details": [], "check_len": null, "definition_context_file_path": "/tf/EBS-IAM.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[1, "resource \"aws_iam_role\" \"ebs_role\" {\n"], [2, "  name = \"ebs_role\"\n"], [3, "\n"], [4, "\n"], [5, "  assume_role_policy = jsonencode({\n"], [6, "    Version = \"2012-10-17\"\n"], [7, "    Statement = [\n"], [8, "      {\n"], [9, "        Action = [\n"], [10, "          \"sts:AssumeRole\",\n"], [11, "          \"sts:TagSession\"\n"], [12, "        ]\n"], [13, "        Effect = \"Allow\"\n"], [14, "        Sid    = \"\"\n"], [15, "        Principal = {\n"], [16, "          Service = \"pods.eks.amazonaws.com\"\n"], [17, "        }\n"], [18, "      },\n"], [19, "    ]\n"], [20, "  })\n"], [21, "\n"], [22, "\n"], [23, "}\n"]], "file_path": "/EBS-IAM.tf", "file_abs_path": "/tf/EBS-IAM.tf", "repo_file_path": "/tf/EBS-IAM.tf", "file_line_range": [1, 23], "resource": "aws_iam_role.ebs_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "/tf/EBS-IAM.tf"}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[1, "resource \"aws_iam_role\" \"ebs_role\" {\n"], [2, "  name = \"ebs_role\"\n"], [3, "\n"], [4, "\n"], [5, "  assume_role_policy = jsonencode({\n"], [6, "    Version = \"2012-10-17\"\n"], [7, "    Statement = [\n"], [8, "      {\n"], [9, "        Action = [\n"], [10, "          \"sts:AssumeRole\",\n"], [11, "          \"sts:TagSession\"\n"], [12, "        ]\n"], [13, "        Effect = \"Allow\"\n"], [14, "        Sid    = \"\"\n"], [15, "        Principal = {\n"], [16, "          Service = \"pods.eks.amazonaws.com\"\n"], [17, "        }\n"], [18, "      },\n"], [19, "    ]\n"], [20, "  })\n"], [21, "\n"], [22, "\n"], [23, "}\n"]], "file_path": "/EBS-IAM.tf", "file_abs_path": "/tf/EBS-IAM.tf", "repo_file_path": "/tf/EBS-IAM.tf", "file_line_range": [1, 23], "resource": "aws_iam_role.ebs_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "/tf/EBS-IAM.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[26, "resource \"aws_iam_role_policy_attachment\" \"ebs-attach\" {\n"], [27, "  role       = aws_iam_role.ebs_role.name\n"], [28, "  policy_arn = \"arn:aws:iam::aws:policy/service-role/AmazonEBSCSIDriverPolicy\"\n"], [29, "}\n"]], "file_path": "/EBS-IAM.tf", "file_abs_path": "/tf/EBS-IAM.tf", "repo_file_path": "/tf/EBS-IAM.tf", "file_line_range": [26, 29], "resource": "aws_iam_role_policy_attachment.ebs-attach", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "/tf/EBS-IAM.tf", "breadcrumbs": {"role": [{"type": "resource", "name": "aws_iam_role.ebs_role", "path": "/tf/EBS-IAM.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[1, "resource \"aws_iam_role\" \"edns_role\" {\n"], [2, "  name = \"edns_role\"\n"], [3, "\n"], [4, "\n"], [5, "  assume_role_policy = jsonencode({\n"], [6, "    Version = \"2012-10-17\"\n"], [7, "    Statement = [\n"], [8, "      {\n"], [9, "        Action = [\n"], [10, "          \"sts:AssumeRole\",\n"], [11, "          \"sts:TagSession\"\n"], [12, "        ]\n"], [13, "        Effect = \"Allow\"\n"], [14, "        Sid    = \"\"\n"], [15, "        Principal = {\n"], [16, "          Service = \"pods.eks.amazonaws.com\"\n"], [17, "        }\n"], [18, "      },\n"], [19, "    ]\n"], [20, "  })\n"], [21, "\n"], [22, "\n"], [23, "}\n"]], "file_path": "/EDNS-IAM.tf", "file_abs_path": "/tf/EDNS-IAM.tf", "repo_file_path": "/tf/EDNS-IAM.tf", "file_line_range": [1, 23], "resource": "aws_iam_role.edns_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44", "details": [], "check_len": null, "definition_context_file_path": "/tf/EDNS-IAM.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[1, "resource \"aws_iam_role\" \"edns_role\" {\n"], [2, "  name = \"edns_role\"\n"], [3, "\n"], [4, "\n"], [5, "  assume_role_policy = jsonencode({\n"], [6, "    Version = \"2012-10-17\"\n"], [7, "    Statement = [\n"], [8, "      {\n"], [9, "        Action = [\n"], [10, "          \"sts:AssumeRole\",\n"], [11, "          \"sts:TagSession\"\n"], [12, "        ]\n"], [13, "        Effect = \"Allow\"\n"], [14, "        Sid    = \"\"\n"], [15, "        Principal = {\n"], [16, "          Service = \"pods.eks.amazonaws.com\"\n"], [17, "        }\n"], [18, "      },\n"], [19, "    ]\n"], [20, "  })\n"], [21, "\n"], [22, "\n"], [23, "}\n"]], "file_path": "/EDNS-IAM.tf", "file_abs_path": "/tf/EDNS-IAM.tf", "repo_file_path": "/tf/EDNS-IAM.tf", "file_line_range": [1, 23], "resource": "aws_iam_role.edns_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "/tf/EDNS-IAM.tf"}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[1, "resource \"aws_iam_role\" \"edns_role\" {\n"], [2, "  name = \"edns_role\"\n"], [3, "\n"], [4, "\n"], [5, "  assume_role_policy = jsonencode({\n"], [6, "    Version = \"2012-10-17\"\n"], [7, "    Statement = [\n"], [8, "      {\n"], [9, "        Action = [\n"], [10, "          \"sts:AssumeRole\",\n"], [11, "          \"sts:TagSession\"\n"], [12, "        ]\n"], [13, "        Effect = \"Allow\"\n"], [14, "        Sid    = \"\"\n"], [15, "        Principal = {\n"], [16, "          Service = \"pods.eks.amazonaws.com\"\n"], [17, "        }\n"], [18, "      },\n"], [19, "    ]\n"], [20, "  })\n"], [21, "\n"], [22, "\n"], [23, "}\n"]], "file_path": "/EDNS-IAM.tf", "file_abs_path": "/tf/EDNS-IAM.tf", "repo_file_path": "/tf/EDNS-IAM.tf", "file_line_range": [1, 23], "resource": "aws_iam_role.edns_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "/tf/EDNS-IAM.tf"}, {"check_id": "CKV_AWS_62", "bc_check_id": "BC_AWS_IAM_47", "check_name": "Ensure IAM policies that allow full \"*-*\" administrative privileges are not created", "check_result": {"result": "PASSED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[24, "resource \"aws_iam_policy\" \"edns-policy\" {\n"], [25, "  name = \"edns-policy\"\n"], [26, "\n"], [27, "  policy = file(\"policies/iam-EDNS.json\")\n"], [28, "}\n"]], "file_path": "/EDNS-IAM.tf", "file_abs_path": "/tf/EDNS-IAM.tf", "repo_file_path": "/tf/EDNS-IAM.tf", "file_line_range": [24, 28], "resource": "aws_iam_policy.edns-policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMAdminPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "/tf/EDNS-IAM.tf"}, {"check_id": "CKV_AWS_63", "bc_check_id": "BC_AWS_IAM_48", "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's actions", "check_result": {"result": "PASSED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[24, "resource \"aws_iam_policy\" \"edns-policy\" {\n"], [25, "  name = \"edns-policy\"\n"], [26, "\n"], [27, "  policy = file(\"policies/iam-EDNS.json\")\n"], [28, "}\n"]], "file_path": "/EDNS-IAM.tf", "file_abs_path": "/tf/EDNS-IAM.tf", "repo_file_path": "/tf/EDNS-IAM.tf", "file_line_range": [24, 28], "resource": "aws_iam_policy.edns-policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMStarActionPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/iam-48", "details": [], "check_len": null, "definition_context_file_path": "/tf/EDNS-IAM.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[29, "resource \"aws_iam_role_policy_attachment\" \"edns-attach\" {\n"], [30, "  role       = aws_iam_role.edns_role.name\n"], [31, "  policy_arn = aws_iam_policy.edns-policy.arn\n"], [32, "}\n"]], "file_path": "/EDNS-IAM.tf", "file_abs_path": "/tf/EDNS-IAM.tf", "repo_file_path": "/tf/EDNS-IAM.tf", "file_line_range": [29, 32], "resource": "aws_iam_role_policy_attachment.edns-attach", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "/tf/EDNS-IAM.tf", "breadcrumbs": {"role": [{"type": "resource", "name": "aws_iam_role.edns_role", "path": "/tf/EDNS-IAM.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_100", "bc_check_id": "BC_AWS_KUBERNETES_5", "check_name": "Ensure AWS EKS node group does not have implicit SSH access from 0.0.0.0/0", "check_result": {"result": "PASSED", "evaluated_keys": ["remote_access/[0]/ec2_ssh_key", "remote_access/[0]/source_security_group_ids"]}, "code_block": [[1, "resource \"aws_eks_node_group\" \"eks_node_group\" {\n"], [2, "  cluster_name    = aws_eks_cluster.eks.name\n"], [3, "  version         = var.eks_version\n"], [4, "  node_group_name = \"${var.cluster_name}-nodes\"\n"], [5, "\n"], [6, "  node_role_arn = aws_iam_role.eks_node_group_role.arn\n"], [7, "  subnet_ids    = aws_subnet.private[*].id\n"], [8, "\n"], [9, "  capacity_type  = \"ON_DEMAND\"\n"], [10, "  instance_types = [var.node_group_instance_type]\n"], [11, "\n"], [12, "  scaling_config {\n"], [13, "    desired_size = 2\n"], [14, "    max_size     = 4\n"], [15, "    min_size     = 1\n"], [16, "  }\n"], [17, "\n"], [18, "  update_config {\n"], [19, "    max_unavailable = 1\n"], [20, "  }\n"], [21, "\n"], [22, "  labels = {\n"], [23, "    role = \"general\"\n"], [24, "  }\n"], [25, "\n"], [26, "  depends_on = [\n"], [27, "    aws_iam_role_policy_attachment.eks_worker_node_policy,\n"], [28, "    aws_iam_role_policy_attachment.eks_cni_policy,\n"], [29, "    aws_iam_role_policy_attachment.ec2_container_registry_readonly\n"], [30, "  ]\n"], [31, "\n"], [32, "  lifecycle {\n"], [33, "    ignore_changes = [scaling_config[0].desired_size]\n"], [34, "  }\n"], [35, "\n"], [36, "}"]], "file_path": "/EKS-NodeGroups.tf", "file_abs_path": "/tf/EKS-NodeGroups.tf", "repo_file_path": "/tf/EKS-NodeGroups.tf", "file_line_range": [1, 36], "resource": "aws_eks_node_group.eks_node_group", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EKSNodeGroupRemoteAccess", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-kubernetes-policies/bc-aws-kubernetes-5", "details": [], "check_len": null, "definition_context_file_path": "/tf/EKS-NodeGroups.tf", "breadcrumbs": {"node_group_name": [{"type": "variable", "name": "cluster_name", "path": "/tf/variables.tf", "module_connection": false}], "instance_types": [{"type": "variable", "name": "node_group_instance_type", "path": "/tf/variables.tf", "module_connection": false}], "version": [{"type": "variable", "name": "eks_version", "path": "/tf/variables.tf", "module_connection": false}], "cluster_name": [{"type": "variable", "name": "cluster_name", "path": "/tf/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_eks_cluster.eks", "path": "/tf/EKS-cluster.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[1, "resource \"aws_iam_role\" \"eso\" {\n"], [2, "  name = \"eso-role\"\n"], [3, "\n"], [4, "  assume_role_policy = jsonencode({\n"], [5, "    Version = \"2012-10-17\"\n"], [6, "    Statement = [\n"], [7, "      {\n"], [8, "        Action = [\n"], [9, "          \"sts:AssumeRole\",\n"], [10, "          \"sts:TagSession\"\n"], [11, "        ]\n"], [12, "        Effect = \"Allow\"\n"], [13, "        Sid    = \"\"\n"], [14, "        Principal = {\n"], [15, "          Service = \"pods.eks.amazonaws.com\"\n"], [16, "        }\n"], [17, "      }\n"], [18, "    ]\n"], [19, "  })\n"], [20, "}\n"]], "file_path": "/ESO-IAM.tf", "file_abs_path": "/tf/ESO-IAM.tf", "repo_file_path": "/tf/ESO-IAM.tf", "file_line_range": [1, 20], "resource": "aws_iam_role.eso", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44", "details": [], "check_len": null, "definition_context_file_path": "/tf/ESO-IAM.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[1, "resource \"aws_iam_role\" \"eso\" {\n"], [2, "  name = \"eso-role\"\n"], [3, "\n"], [4, "  assume_role_policy = jsonencode({\n"], [5, "    Version = \"2012-10-17\"\n"], [6, "    Statement = [\n"], [7, "      {\n"], [8, "        Action = [\n"], [9, "          \"sts:AssumeRole\",\n"], [10, "          \"sts:TagSession\"\n"], [11, "        ]\n"], [12, "        Effect = \"Allow\"\n"], [13, "        Sid    = \"\"\n"], [14, "        Principal = {\n"], [15, "          Service = \"pods.eks.amazonaws.com\"\n"], [16, "        }\n"], [17, "      }\n"], [18, "    ]\n"], [19, "  })\n"], [20, "}\n"]], "file_path": "/ESO-IAM.tf", "file_abs_path": "/tf/ESO-IAM.tf", "repo_file_path": "/tf/ESO-IAM.tf", "file_line_range": [1, 20], "resource": "aws_iam_role.eso", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "/tf/ESO-IAM.tf"}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[1, "resource \"aws_iam_role\" \"eso\" {\n"], [2, "  name = \"eso-role\"\n"], [3, "\n"], [4, "  assume_role_policy = jsonencode({\n"], [5, "    Version = \"2012-10-17\"\n"], [6, "    Statement = [\n"], [7, "      {\n"], [8, "        Action = [\n"], [9, "          \"sts:AssumeRole\",\n"], [10, "          \"sts:TagSession\"\n"], [11, "        ]\n"], [12, "        Effect = \"Allow\"\n"], [13, "        Sid    = \"\"\n"], [14, "        Principal = {\n"], [15, "          Service = \"pods.eks.amazonaws.com\"\n"], [16, "        }\n"], [17, "      }\n"], [18, "    ]\n"], [19, "  })\n"], [20, "}\n"]], "file_path": "/ESO-IAM.tf", "file_abs_path": "/tf/ESO-IAM.tf", "repo_file_path": "/tf/ESO-IAM.tf", "file_line_range": [1, 20], "resource": "aws_iam_role.eso", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "/tf/ESO-IAM.tf"}, {"check_id": "CKV_AWS_62", "bc_check_id": "BC_AWS_IAM_47", "check_name": "Ensure IAM policies that allow full \"*-*\" administrative privileges are not created", "check_result": {"result": "PASSED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[22, "resource \"aws_iam_policy\" \"eso-policy\" {\n"], [23, "  name        = \"eso-policy\"\n"], [24, "\n"], [25, "  policy = file(\"policies/iam_eso.json\")\n"], [26, "}\n"]], "file_path": "/ESO-IAM.tf", "file_abs_path": "/tf/ESO-IAM.tf", "repo_file_path": "/tf/ESO-IAM.tf", "file_line_range": [22, 26], "resource": "aws_iam_policy.eso-policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMAdminPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "/tf/ESO-IAM.tf"}, {"check_id": "CKV_AWS_63", "bc_check_id": "BC_AWS_IAM_48", "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's actions", "check_result": {"result": "PASSED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[22, "resource \"aws_iam_policy\" \"eso-policy\" {\n"], [23, "  name        = \"eso-policy\"\n"], [24, "\n"], [25, "  policy = file(\"policies/iam_eso.json\")\n"], [26, "}\n"]], "file_path": "/ESO-IAM.tf", "file_abs_path": "/tf/ESO-IAM.tf", "repo_file_path": "/tf/ESO-IAM.tf", "file_line_range": [22, 26], "resource": "aws_iam_policy.eso-policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMStarActionPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/iam-48", "details": [], "check_len": null, "definition_context_file_path": "/tf/ESO-IAM.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[28, "resource \"aws_iam_role_policy_attachment\" \"eso-attach\" {\n"], [29, "  role       = aws_iam_role.eso.name\n"], [30, "  policy_arn = aws_iam_policy.eso-policy.arn\n"], [31, "}\n"]], "file_path": "/ESO-IAM.tf", "file_abs_path": "/tf/ESO-IAM.tf", "repo_file_path": "/tf/ESO-IAM.tf", "file_line_range": [28, 31], "resource": "aws_iam_role_policy_attachment.eso-attach", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "/tf/ESO-IAM.tf", "breadcrumbs": {"role": [{"type": "resource", "name": "aws_iam_role.eso", "path": "/tf/ESO-IAM.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[1, "resource \"aws_iam_role\" \"eks_cluster_role\" {\n"], [2, "  name = \"eks-cluster-role\"\n"], [3, "  assume_role_policy = jsonencode({\n"], [4, "    Version   = \"2012-10-17\"\n"], [5, "    Statement = [{ Action = \"sts:AssumeRole\", Effect = \"Allow\", Principal = { Service = \"eks.amazonaws.com\" } }]\n"], [6, "  })\n"], [7, "}\n"]], "file_path": "/IAM-EKS.tf", "file_abs_path": "/tf/IAM-EKS.tf", "repo_file_path": "/tf/IAM-EKS.tf", "file_line_range": [1, 7], "resource": "aws_iam_role.eks_cluster_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44", "details": [], "check_len": null, "definition_context_file_path": "/tf/IAM-EKS.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[1, "resource \"aws_iam_role\" \"eks_cluster_role\" {\n"], [2, "  name = \"eks-cluster-role\"\n"], [3, "  assume_role_policy = jsonencode({\n"], [4, "    Version   = \"2012-10-17\"\n"], [5, "    Statement = [{ Action = \"sts:AssumeRole\", Effect = \"Allow\", Principal = { Service = \"eks.amazonaws.com\" } }]\n"], [6, "  })\n"], [7, "}\n"]], "file_path": "/IAM-EKS.tf", "file_abs_path": "/tf/IAM-EKS.tf", "repo_file_path": "/tf/IAM-EKS.tf", "file_line_range": [1, 7], "resource": "aws_iam_role.eks_cluster_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "/tf/IAM-EKS.tf"}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[1, "resource \"aws_iam_role\" \"eks_cluster_role\" {\n"], [2, "  name = \"eks-cluster-role\"\n"], [3, "  assume_role_policy = jsonencode({\n"], [4, "    Version   = \"2012-10-17\"\n"], [5, "    Statement = [{ Action = \"sts:AssumeRole\", Effect = \"Allow\", Principal = { Service = \"eks.amazonaws.com\" } }]\n"], [6, "  })\n"], [7, "}\n"]], "file_path": "/IAM-EKS.tf", "file_abs_path": "/tf/IAM-EKS.tf", "repo_file_path": "/tf/IAM-EKS.tf", "file_line_range": [1, 7], "resource": "aws_iam_role.eks_cluster_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "/tf/IAM-EKS.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[9, "resource \"aws_iam_role_policy_attachment\" \"eks_cluster_policy\" {\n"], [10, "  policy_arn = \"arn:aws:iam::aws:policy/AmazonEKSClusterPolicy\"\n"], [11, "  role       = aws_iam_role.eks_cluster_role.name\n"], [12, "}\n"]], "file_path": "/IAM-EKS.tf", "file_abs_path": "/tf/IAM-EKS.tf", "repo_file_path": "/tf/IAM-EKS.tf", "file_line_range": [9, 12], "resource": "aws_iam_role_policy_attachment.eks_cluster_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "/tf/IAM-EKS.tf", "breadcrumbs": {"role": [{"type": "resource", "name": "aws_iam_role.eks_cluster_role", "path": "/tf/IAM-EKS.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[2, "resource \"aws_iam_role\" \"eks_node_group_role\" {\n"], [3, "  name = \"eks-node-group-role\"\n"], [4, "  assume_role_policy = jsonencode({\n"], [5, "    Version   = \"2012-10-17\"\n"], [6, "    Statement = [{ Action = \"sts:AssumeRole\", Effect = \"Allow\", Principal = { Service = \"ec2.amazonaws.com\" } }]\n"], [7, "  })\n"], [8, "}\n"]], "file_path": "/IAM-Node-Groups.tf", "file_abs_path": "/tf/IAM-Node-Groups.tf", "repo_file_path": "/tf/IAM-Node-Groups.tf", "file_line_range": [2, 8], "resource": "aws_iam_role.eks_node_group_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44", "details": [], "check_len": null, "definition_context_file_path": "/tf/IAM-Node-Groups.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[2, "resource \"aws_iam_role\" \"eks_node_group_role\" {\n"], [3, "  name = \"eks-node-group-role\"\n"], [4, "  assume_role_policy = jsonencode({\n"], [5, "    Version   = \"2012-10-17\"\n"], [6, "    Statement = [{ Action = \"sts:AssumeRole\", Effect = \"Allow\", Principal = { Service = \"ec2.amazonaws.com\" } }]\n"], [7, "  })\n"], [8, "}\n"]], "file_path": "/IAM-Node-Groups.tf", "file_abs_path": "/tf/IAM-Node-Groups.tf", "repo_file_path": "/tf/IAM-Node-Groups.tf", "file_line_range": [2, 8], "resource": "aws_iam_role.eks_node_group_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "/tf/IAM-Node-Groups.tf"}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[2, "resource \"aws_iam_role\" \"eks_node_group_role\" {\n"], [3, "  name = \"eks-node-group-role\"\n"], [4, "  assume_role_policy = jsonencode({\n"], [5, "    Version   = \"2012-10-17\"\n"], [6, "    Statement = [{ Action = \"sts:AssumeRole\", Effect = \"Allow\", Principal = { Service = \"ec2.amazonaws.com\" } }]\n"], [7, "  })\n"], [8, "}\n"]], "file_path": "/IAM-Node-Groups.tf", "file_abs_path": "/tf/IAM-Node-Groups.tf", "repo_file_path": "/tf/IAM-Node-Groups.tf", "file_line_range": [2, 8], "resource": "aws_iam_role.eks_node_group_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "/tf/IAM-Node-Groups.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[10, "resource \"aws_iam_role_policy_attachment\" \"eks_worker_node_policy\" {\n"], [11, "  policy_arn = \"arn:aws:iam::aws:policy/AmazonEKSWorkerNodePolicy\"\n"], [12, "  role       = aws_iam_role.eks_node_group_role.name\n"], [13, "}\n"]], "file_path": "/IAM-Node-Groups.tf", "file_abs_path": "/tf/IAM-Node-Groups.tf", "repo_file_path": "/tf/IAM-Node-Groups.tf", "file_line_range": [10, 13], "resource": "aws_iam_role_policy_attachment.eks_worker_node_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "/tf/IAM-Node-Groups.tf", "breadcrumbs": {"role": [{"type": "resource", "name": "aws_iam_role.eks_node_group_role", "path": "/tf/IAM-Node-Groups.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[15, "resource \"aws_iam_role_policy_attachment\" \"eks_cni_policy\" {\n"], [16, "  policy_arn = \"arn:aws:iam::aws:policy/AmazonEKS_CNI_Policy\"\n"], [17, "  role       = aws_iam_role.eks_node_group_role.name\n"], [18, "}\n"]], "file_path": "/IAM-Node-Groups.tf", "file_abs_path": "/tf/IAM-Node-Groups.tf", "repo_file_path": "/tf/IAM-Node-Groups.tf", "file_line_range": [15, 18], "resource": "aws_iam_role_policy_attachment.eks_cni_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "/tf/IAM-Node-Groups.tf", "breadcrumbs": {"role": [{"type": "resource", "name": "aws_iam_role.eks_node_group_role", "path": "/tf/IAM-Node-Groups.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[20, "resource \"aws_iam_role_policy_attachment\" \"ec2_container_registry_readonly\" {\n"], [21, "  policy_arn = \"arn:aws:iam::aws:policy/AmazonEC2ContainerRegistryReadOnly\"\n"], [22, "  role       = aws_iam_role.eks_node_group_role.name\n"], [23, "}"]], "file_path": "/IAM-Node-Groups.tf", "file_abs_path": "/tf/IAM-Node-Groups.tf", "repo_file_path": "/tf/IAM-Node-Groups.tf", "file_line_range": [20, 23], "resource": "aws_iam_role_policy_attachment.ec2_container_registry_readonly", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "/tf/IAM-Node-Groups.tf", "breadcrumbs": {"role": [{"type": "resource", "name": "aws_iam_role.eks_node_group_role", "path": "/tf/IAM-Node-Groups.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[1, "resource \"aws_iam_role\" \"lbc_role\" {\n"], [2, "  name = \"lbc-role\"\n"], [3, "\n"], [4, "  assume_role_policy = jsonencode({\n"], [5, "    Version = \"2012-10-17\"\n"], [6, "    Statement = [\n"], [7, "      {\n"], [8, "        Action = [\n"], [9, "          \"sts:AssumeRole\",\n"], [10, "          \"sts:TagSession\"\n"], [11, "        ]\n"], [12, "        Effect = \"Allow\"\n"], [13, "        Sid    = \"\"\n"], [14, "        Principal = {\n"], [15, "          Service = \"pods.eks.amazonaws.com\"\n"], [16, "        }\n"], [17, "      }\n"], [18, "    ]\n"], [19, "  })\n"], [20, "}\n"]], "file_path": "/LBC-IAM.tf", "file_abs_path": "/tf/LBC-IAM.tf", "repo_file_path": "/tf/LBC-IAM.tf", "file_line_range": [1, 20], "resource": "aws_iam_role.lbc_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44", "details": [], "check_len": null, "definition_context_file_path": "/tf/LBC-IAM.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[1, "resource \"aws_iam_role\" \"lbc_role\" {\n"], [2, "  name = \"lbc-role\"\n"], [3, "\n"], [4, "  assume_role_policy = jsonencode({\n"], [5, "    Version = \"2012-10-17\"\n"], [6, "    Statement = [\n"], [7, "      {\n"], [8, "        Action = [\n"], [9, "          \"sts:AssumeRole\",\n"], [10, "          \"sts:TagSession\"\n"], [11, "        ]\n"], [12, "        Effect = \"Allow\"\n"], [13, "        Sid    = \"\"\n"], [14, "        Principal = {\n"], [15, "          Service = \"pods.eks.amazonaws.com\"\n"], [16, "        }\n"], [17, "      }\n"], [18, "    ]\n"], [19, "  })\n"], [20, "}\n"]], "file_path": "/LBC-IAM.tf", "file_abs_path": "/tf/LBC-IAM.tf", "repo_file_path": "/tf/LBC-IAM.tf", "file_line_range": [1, 20], "resource": "aws_iam_role.lbc_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "/tf/LBC-IAM.tf"}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[1, "resource \"aws_iam_role\" \"lbc_role\" {\n"], [2, "  name = \"lbc-role\"\n"], [3, "\n"], [4, "  assume_role_policy = jsonencode({\n"], [5, "    Version = \"2012-10-17\"\n"], [6, "    Statement = [\n"], [7, "      {\n"], [8, "        Action = [\n"], [9, "          \"sts:AssumeRole\",\n"], [10, "          \"sts:TagSession\"\n"], [11, "        ]\n"], [12, "        Effect = \"Allow\"\n"], [13, "        Sid    = \"\"\n"], [14, "        Principal = {\n"], [15, "          Service = \"pods.eks.amazonaws.com\"\n"], [16, "        }\n"], [17, "      }\n"], [18, "    ]\n"], [19, "  })\n"], [20, "}\n"]], "file_path": "/LBC-IAM.tf", "file_abs_path": "/tf/LBC-IAM.tf", "repo_file_path": "/tf/LBC-IAM.tf", "file_line_range": [1, 20], "resource": "aws_iam_role.lbc_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "/tf/LBC-IAM.tf"}, {"check_id": "CKV_AWS_62", "bc_check_id": "BC_AWS_IAM_47", "check_name": "Ensure IAM policies that allow full \"*-*\" administrative privileges are not created", "check_result": {"result": "PASSED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[22, "resource \"aws_iam_policy\" \"lbc_policy\" {\n"], [23, "  name   = \"lbc-policy\"\n"], [24, "  policy = file(\"policies/iam_lbc.json\")\n"], [25, "}\n"]], "file_path": "/LBC-IAM.tf", "file_abs_path": "/tf/LBC-IAM.tf", "repo_file_path": "/tf/LBC-IAM.tf", "file_line_range": [22, 25], "resource": "aws_iam_policy.lbc_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMAdminPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "/tf/LBC-IAM.tf"}, {"check_id": "CKV_AWS_63", "bc_check_id": "BC_AWS_IAM_48", "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's actions", "check_result": {"result": "PASSED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[22, "resource \"aws_iam_policy\" \"lbc_policy\" {\n"], [23, "  name   = \"lbc-policy\"\n"], [24, "  policy = file(\"policies/iam_lbc.json\")\n"], [25, "}\n"]], "file_path": "/LBC-IAM.tf", "file_abs_path": "/tf/LBC-IAM.tf", "repo_file_path": "/tf/LBC-IAM.tf", "file_line_range": [22, 25], "resource": "aws_iam_policy.lbc_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMStarActionPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/iam-48", "details": [], "check_len": null, "definition_context_file_path": "/tf/LBC-IAM.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[27, "resource \"aws_iam_role_policy_attachment\" \"lbc_attach\" {\n"], [28, "  role       = aws_iam_role.lbc_role.name\n"], [29, "  policy_arn = aws_iam_policy.lbc_policy.arn\n"], [30, "}\n"]], "file_path": "/LBC-IAM.tf", "file_abs_path": "/tf/LBC-IAM.tf", "repo_file_path": "/tf/LBC-IAM.tf", "file_line_range": [27, 30], "resource": "aws_iam_role_policy_attachment.lbc_attach", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "/tf/LBC-IAM.tf", "breadcrumbs": {"role": [{"type": "resource", "name": "aws_iam_role.lbc_role", "path": "/tf/LBC-IAM.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_234", "bc_check_id": "BC_AWS_GENERAL_173", "check_name": "Verify logging preference for ACM certificates", "check_result": {"result": "PASSED", "evaluated_keys": ["options/[0]/certificate_transparency_logging_preference"]}, "code_block": [[1, "resource \"aws_acm_certificate\" \"users\" {\n"], [2, "  domain_name       = var.users_domain\n"], [3, "  validation_method = \"DNS\"\n"], [4, "\n"], [5, "  lifecycle {\n"], [6, "    create_before_destroy = true\n"], [7, "  }\n"], [8, "\n"], [9, "  tags = {\n"], [10, "    Name        = var.users_domain\n"], [11, "    Environment = \"production\"\n"], [12, "  }\n"], [13, "}\n"]], "file_path": "/acm.tf", "file_abs_path": "/tf/acm.tf", "repo_file_path": "/tf/acm.tf", "file_line_range": [1, 13], "resource": "aws_acm_certificate.users", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ACMCertSetLoggingPreference", "fixed_definition": null, "entity_tags": {"Environment": "production", "Name": "shebl22.me"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-acm-certificates-has-logging-preference", "details": [], "check_len": null, "definition_context_file_path": "/tf/acm.tf", "breadcrumbs": {"domain_name": [{"type": "variable", "name": "users_domain", "path": "/tf/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "users_domain", "path": "/tf/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_233", "bc_check_id": "BC_AWS_NETWORKING_69", "check_name": "Ensure Create before destroy for ACM certificates", "check_result": {"result": "PASSED", "evaluated_keys": ["lifecycle/[0]/create_before_destroy"]}, "code_block": [[1, "resource \"aws_acm_certificate\" \"users\" {\n"], [2, "  domain_name       = var.users_domain\n"], [3, "  validation_method = \"DNS\"\n"], [4, "\n"], [5, "  lifecycle {\n"], [6, "    create_before_destroy = true\n"], [7, "  }\n"], [8, "\n"], [9, "  tags = {\n"], [10, "    Name        = var.users_domain\n"], [11, "    Environment = \"production\"\n"], [12, "  }\n"], [13, "}\n"]], "file_path": "/acm.tf", "file_abs_path": "/tf/acm.tf", "repo_file_path": "/tf/acm.tf", "file_line_range": [1, 13], "resource": "aws_acm_certificate.users", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ACMCertCreateBeforeDestroy", "fixed_definition": null, "entity_tags": {"Environment": "production", "Name": "shebl22.me"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-acm-certificate-enables-create-before-destroy", "details": [], "check_len": null, "definition_context_file_path": "/tf/acm.tf", "breadcrumbs": {"domain_name": [{"type": "variable", "name": "users_domain", "path": "/tf/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "users_domain", "path": "/tf/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_41", "bc_check_id": "BC_AWS_SECRETS_5", "check_name": "Ensure no hard coded AWS access key and secret key exists in provider", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[24, "provider \"aws\" {\n"], [25, "  region = var.region\n"], [26, "}\n"]], "file_path": "/providers.tf", "file_abs_path": "/tf/providers.tf", "repo_file_path": "/tf/providers.tf", "file_line_range": [24, 26], "resource": "aws.default", "evaluations": null, "check_class": "checkov.terraform.checks.provider.aws.credentials", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-5", "details": [], "check_len": null, "definition_context_file_path": "/tf/providers.tf", "breadcrumbs": {"region": [{"type": "variable", "name": "region", "path": "/tf/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_130", "bc_check_id": "BC_AWS_NETWORKING_53", "check_name": "Ensure VPC subnets do not assign public IP by default", "check_result": {"result": "PASSED", "evaluated_keys": ["map_public_ip_on_launch"]}, "code_block": [[26, "resource \"aws_subnet\" \"private\" {\n"], [27, "  count = length(var.private_subnets)\n"], [28, "\n"], [29, "  vpc_id            = aws_vpc.main.id\n"], [30, "  cidr_block        = var.private_subnets[count.index]\n"], [31, "  availability_zone = element(data.aws_availability_zones.available.names, count.index)\n"], [32, "\n"], [33, "  tags = {\n"], [34, "    Name                                        = \"${var.cluster_name}-private-subnet-${count.index + 1}\"\n"], [35, "    \"kubernetes.io/cluster/${var.cluster_name}\" = \"shared\"\n"], [36, "    \"kubernetes.io/role/internal-elb\"           = \"1\" # For internal load balancers\n"], [37, "  }\n"], [38, "}\n"]], "file_path": "/vpc.tf", "file_abs_path": "/tf/vpc.tf", "repo_file_path": "/tf/vpc.tf", "file_line_range": [26, 38], "resource": "aws_subnet.private[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SubnetPublicIP", "fixed_definition": null, "entity_tags": {"Name": "EKS-cluster-private-subnet-${0 + 1}", "kubernetes.io/cluster/${var.cluster_name}": "shared", "kubernetes.io/role/internal-elb": "1"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default", "details": [], "check_len": null, "definition_context_file_path": "/tf/vpc.tf", "breadcrumbs": {"tags.Name": [{"type": "variable", "name": "cluster_name", "path": "/tf/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_130", "bc_check_id": "BC_AWS_NETWORKING_53", "check_name": "Ensure VPC subnets do not assign public IP by default", "check_result": {"result": "PASSED", "evaluated_keys": ["map_public_ip_on_launch"]}, "code_block": [[26, "resource \"aws_subnet\" \"private\" {\n"], [27, "  count = length(var.private_subnets)\n"], [28, "\n"], [29, "  vpc_id            = aws_vpc.main.id\n"], [30, "  cidr_block        = var.private_subnets[count.index]\n"], [31, "  availability_zone = element(data.aws_availability_zones.available.names, count.index)\n"], [32, "\n"], [33, "  tags = {\n"], [34, "    Name                                        = \"${var.cluster_name}-private-subnet-${count.index + 1}\"\n"], [35, "    \"kubernetes.io/cluster/${var.cluster_name}\" = \"shared\"\n"], [36, "    \"kubernetes.io/role/internal-elb\"           = \"1\" # For internal load balancers\n"], [37, "  }\n"], [38, "}\n"]], "file_path": "/vpc.tf", "file_abs_path": "/tf/vpc.tf", "repo_file_path": "/tf/vpc.tf", "file_line_range": [26, 38], "resource": "aws_subnet.private[1]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SubnetPublicIP", "fixed_definition": null, "entity_tags": {"Name": "EKS-cluster-private-subnet-${1 + 1}", "kubernetes.io/cluster/${var.cluster_name}": "shared", "kubernetes.io/role/internal-elb": "1"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default", "details": [], "check_len": null, "definition_context_file_path": "/tf/vpc.tf", "breadcrumbs": {"tags.Name": [{"type": "variable", "name": "cluster_name", "path": "/tf/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role": {"ebs_role": {"__end_line__": 23, "__start_line__": 1, "assume_role_policy": [{"Version": "2012-10-17", "Statement": [{"Action": ["sts:AssumeRole", "sts:TagSession"], "Effect": "Allow", "Sid": "", "Principal": {"Service": "pods.eks.amazonaws.com"}}]}], "name": ["ebs_role"], "__address__": "aws_iam_role.ebs_role"}}}, "evaluated_keys": ["arn", "managed_policy_arn", "name", "managed_policy_arns/*", "policy_arn"]}, "code_block": [[1, "resource \"aws_iam_role\" \"ebs_role\" {\n"], [2, "  name = \"ebs_role\"\n"], [3, "\n"], [4, "\n"], [5, "  assume_role_policy = jsonencode({\n"], [6, "    Version = \"2012-10-17\"\n"], [7, "    Statement = [\n"], [8, "      {\n"], [9, "        Action = [\n"], [10, "          \"sts:AssumeRole\",\n"], [11, "          \"sts:TagSession\"\n"], [12, "        ]\n"], [13, "        Effect = \"Allow\"\n"], [14, "        Sid    = \"\"\n"], [15, "        Principal = {\n"], [16, "          Service = \"pods.eks.amazonaws.com\"\n"], [17, "        }\n"], [18, "      },\n"], [19, "    ]\n"], [20, "  })\n"], [21, "\n"], [22, "\n"], [23, "}\n"]], "file_path": "/EBS-IAM.tf", "file_abs_path": "/tf/EBS-IAM.tf", "repo_file_path": "/tf/EBS-IAM.tf", "file_line_range": [1, 23], "resource": "aws_iam_role.ebs_role", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "/tf/EBS-IAM.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role_policy_attachment": {"ebs-attach": {"__end_line__": 29, "__start_line__": 26, "policy_arn": ["arn:aws:iam::aws:policy/service-role/AmazonEBSCSIDriverPolicy"], "role": ["ebs_role"], "__address__": "aws_iam_role_policy_attachment.ebs-attach"}}}, "evaluated_keys": ["arn", "managed_policy_arn", "name", "managed_policy_arns/*", "policy_arn"]}, "code_block": [[26, "resource \"aws_iam_role_policy_attachment\" \"ebs-attach\" {\n"], [27, "  role       = aws_iam_role.ebs_role.name\n"], [28, "  policy_arn = \"arn:aws:iam::aws:policy/service-role/AmazonEBSCSIDriverPolicy\"\n"], [29, "}\n"]], "file_path": "/EBS-IAM.tf", "file_abs_path": "/tf/EBS-IAM.tf", "repo_file_path": "/tf/EBS-IAM.tf", "file_line_range": [26, 29], "resource": "aws_iam_role_policy_attachment.ebs-attach", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "/tf/EBS-IAM.tf", "breadcrumbs": {"role": [{"type": "resource", "name": "aws_iam_role.ebs_role", "path": "/tf/EBS-IAM.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role": {"edns_role": {"__end_line__": 23, "__start_line__": 1, "assume_role_policy": [{"Version": "2012-10-17", "Statement": [{"Action": ["sts:AssumeRole", "sts:TagSession"], "Effect": "Allow", "Sid": "", "Principal": {"Service": "pods.eks.amazonaws.com"}}]}], "name": ["edns_role"], "__address__": "aws_iam_role.edns_role"}}}, "evaluated_keys": ["arn", "managed_policy_arn", "name", "managed_policy_arns/*", "policy_arn"]}, "code_block": [[1, "resource \"aws_iam_role\" \"edns_role\" {\n"], [2, "  name = \"edns_role\"\n"], [3, "\n"], [4, "\n"], [5, "  assume_role_policy = jsonencode({\n"], [6, "    Version = \"2012-10-17\"\n"], [7, "    Statement = [\n"], [8, "      {\n"], [9, "        Action = [\n"], [10, "          \"sts:AssumeRole\",\n"], [11, "          \"sts:TagSession\"\n"], [12, "        ]\n"], [13, "        Effect = \"Allow\"\n"], [14, "        Sid    = \"\"\n"], [15, "        Principal = {\n"], [16, "          Service = \"pods.eks.amazonaws.com\"\n"], [17, "        }\n"], [18, "      },\n"], [19, "    ]\n"], [20, "  })\n"], [21, "\n"], [22, "\n"], [23, "}\n"]], "file_path": "/EDNS-IAM.tf", "file_abs_path": "/tf/EDNS-IAM.tf", "repo_file_path": "/tf/EDNS-IAM.tf", "file_line_range": [1, 23], "resource": "aws_iam_role.edns_role", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "/tf/EDNS-IAM.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role": {"eso": {"__end_line__": 20, "__start_line__": 1, "assume_role_policy": [{"Version": "2012-10-17", "Statement": [{"Action": ["sts:AssumeRole", "sts:TagSession"], "Effect": "Allow", "Sid": "", "Principal": {"Service": "pods.eks.amazonaws.com"}}]}], "name": ["eso-role"], "__address__": "aws_iam_role.eso"}}}, "evaluated_keys": ["arn", "managed_policy_arn", "name", "managed_policy_arns/*", "policy_arn"]}, "code_block": [[1, "resource \"aws_iam_role\" \"eso\" {\n"], [2, "  name = \"eso-role\"\n"], [3, "\n"], [4, "  assume_role_policy = jsonencode({\n"], [5, "    Version = \"2012-10-17\"\n"], [6, "    Statement = [\n"], [7, "      {\n"], [8, "        Action = [\n"], [9, "          \"sts:AssumeRole\",\n"], [10, "          \"sts:TagSession\"\n"], [11, "        ]\n"], [12, "        Effect = \"Allow\"\n"], [13, "        Sid    = \"\"\n"], [14, "        Principal = {\n"], [15, "          Service = \"pods.eks.amazonaws.com\"\n"], [16, "        }\n"], [17, "      }\n"], [18, "    ]\n"], [19, "  })\n"], [20, "}\n"]], "file_path": "/ESO-IAM.tf", "file_abs_path": "/tf/ESO-IAM.tf", "repo_file_path": "/tf/ESO-IAM.tf", "file_line_range": [1, 20], "resource": "aws_iam_role.eso", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "/tf/ESO-IAM.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role": {"eks_cluster_role": {"__end_line__": 7, "__start_line__": 1, "assume_role_policy": [{"Version": "2012-10-17", "Statement": [{"Action": "sts:AssumeRole", "Effect": "Allow", "Principal": {"Service": "eks.amazonaws.com"}}]}], "name": ["eks-cluster-role"], "__address__": "aws_iam_role.eks_cluster_role"}}}, "evaluated_keys": ["arn", "managed_policy_arn", "name", "managed_policy_arns/*", "policy_arn"]}, "code_block": [[1, "resource \"aws_iam_role\" \"eks_cluster_role\" {\n"], [2, "  name = \"eks-cluster-role\"\n"], [3, "  assume_role_policy = jsonencode({\n"], [4, "    Version   = \"2012-10-17\"\n"], [5, "    Statement = [{ Action = \"sts:AssumeRole\", Effect = \"Allow\", Principal = { Service = \"eks.amazonaws.com\" } }]\n"], [6, "  })\n"], [7, "}\n"]], "file_path": "/IAM-EKS.tf", "file_abs_path": "/tf/IAM-EKS.tf", "repo_file_path": "/tf/IAM-EKS.tf", "file_line_range": [1, 7], "resource": "aws_iam_role.eks_cluster_role", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "/tf/IAM-EKS.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role_policy_attachment": {"eks_cluster_policy": {"__end_line__": 12, "__start_line__": 9, "policy_arn": ["arn:aws:iam::aws:policy/AmazonEKSClusterPolicy"], "role": ["eks-cluster-role"], "__address__": "aws_iam_role_policy_attachment.eks_cluster_policy"}}}, "evaluated_keys": ["arn", "managed_policy_arn", "name", "managed_policy_arns/*", "policy_arn"]}, "code_block": [[9, "resource \"aws_iam_role_policy_attachment\" \"eks_cluster_policy\" {\n"], [10, "  policy_arn = \"arn:aws:iam::aws:policy/AmazonEKSClusterPolicy\"\n"], [11, "  role       = aws_iam_role.eks_cluster_role.name\n"], [12, "}\n"]], "file_path": "/IAM-EKS.tf", "file_abs_path": "/tf/IAM-EKS.tf", "repo_file_path": "/tf/IAM-EKS.tf", "file_line_range": [9, 12], "resource": "aws_iam_role_policy_attachment.eks_cluster_policy", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "/tf/IAM-EKS.tf", "breadcrumbs": {"role": [{"type": "resource", "name": "aws_iam_role.eks_cluster_role", "path": "/tf/IAM-EKS.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role": {"eks_node_group_role": {"__end_line__": 8, "__start_line__": 2, "assume_role_policy": [{"Version": "2012-10-17", "Statement": [{"Action": "sts:AssumeRole", "Effect": "Allow", "Principal": {"Service": "ec2.amazonaws.com"}}]}], "name": ["eks-node-group-role"], "__address__": "aws_iam_role.eks_node_group_role"}}}, "evaluated_keys": ["arn", "managed_policy_arn", "name", "managed_policy_arns/*", "policy_arn"]}, "code_block": [[2, "resource \"aws_iam_role\" \"eks_node_group_role\" {\n"], [3, "  name = \"eks-node-group-role\"\n"], [4, "  assume_role_policy = jsonencode({\n"], [5, "    Version   = \"2012-10-17\"\n"], [6, "    Statement = [{ Action = \"sts:AssumeRole\", Effect = \"Allow\", Principal = { Service = \"ec2.amazonaws.com\" } }]\n"], [7, "  })\n"], [8, "}\n"]], "file_path": "/IAM-Node-Groups.tf", "file_abs_path": "/tf/IAM-Node-Groups.tf", "repo_file_path": "/tf/IAM-Node-Groups.tf", "file_line_range": [2, 8], "resource": "aws_iam_role.eks_node_group_role", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "/tf/IAM-Node-Groups.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role_policy_attachment": {"eks_worker_node_policy": {"__end_line__": 13, "__start_line__": 10, "policy_arn": ["arn:aws:iam::aws:policy/AmazonEKSWorkerNodePolicy"], "role": ["eks-node-group-role"], "__address__": "aws_iam_role_policy_attachment.eks_worker_node_policy"}}}, "evaluated_keys": ["arn", "managed_policy_arn", "name", "managed_policy_arns/*", "policy_arn"]}, "code_block": [[10, "resource \"aws_iam_role_policy_attachment\" \"eks_worker_node_policy\" {\n"], [11, "  policy_arn = \"arn:aws:iam::aws:policy/AmazonEKSWorkerNodePolicy\"\n"], [12, "  role       = aws_iam_role.eks_node_group_role.name\n"], [13, "}\n"]], "file_path": "/IAM-Node-Groups.tf", "file_abs_path": "/tf/IAM-Node-Groups.tf", "repo_file_path": "/tf/IAM-Node-Groups.tf", "file_line_range": [10, 13], "resource": "aws_iam_role_policy_attachment.eks_worker_node_policy", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "/tf/IAM-Node-Groups.tf", "breadcrumbs": {"role": [{"type": "resource", "name": "aws_iam_role.eks_node_group_role", "path": "/tf/IAM-Node-Groups.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role_policy_attachment": {"eks_cni_policy": {"__end_line__": 18, "__start_line__": 15, "policy_arn": ["arn:aws:iam::aws:policy/AmazonEKS_CNI_Policy"], "role": ["eks-node-group-role"], "__address__": "aws_iam_role_policy_attachment.eks_cni_policy"}}}, "evaluated_keys": ["arn", "managed_policy_arn", "name", "managed_policy_arns/*", "policy_arn"]}, "code_block": [[15, "resource \"aws_iam_role_policy_attachment\" \"eks_cni_policy\" {\n"], [16, "  policy_arn = \"arn:aws:iam::aws:policy/AmazonEKS_CNI_Policy\"\n"], [17, "  role       = aws_iam_role.eks_node_group_role.name\n"], [18, "}\n"]], "file_path": "/IAM-Node-Groups.tf", "file_abs_path": "/tf/IAM-Node-Groups.tf", "repo_file_path": "/tf/IAM-Node-Groups.tf", "file_line_range": [15, 18], "resource": "aws_iam_role_policy_attachment.eks_cni_policy", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "/tf/IAM-Node-Groups.tf", "breadcrumbs": {"role": [{"type": "resource", "name": "aws_iam_role.eks_node_group_role", "path": "/tf/IAM-Node-Groups.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role_policy_attachment": {"ec2_container_registry_readonly": {"__end_line__": 23, "__start_line__": 20, "policy_arn": ["arn:aws:iam::aws:policy/AmazonEC2ContainerRegistryReadOnly"], "role": ["eks-node-group-role"], "__address__": "aws_iam_role_policy_attachment.ec2_container_registry_readonly"}}}, "evaluated_keys": ["arn", "managed_policy_arn", "name", "managed_policy_arns/*", "policy_arn"]}, "code_block": [[20, "resource \"aws_iam_role_policy_attachment\" \"ec2_container_registry_readonly\" {\n"], [21, "  policy_arn = \"arn:aws:iam::aws:policy/AmazonEC2ContainerRegistryReadOnly\"\n"], [22, "  role       = aws_iam_role.eks_node_group_role.name\n"], [23, "}"]], "file_path": "/IAM-Node-Groups.tf", "file_abs_path": "/tf/IAM-Node-Groups.tf", "repo_file_path": "/tf/IAM-Node-Groups.tf", "file_line_range": [20, 23], "resource": "aws_iam_role_policy_attachment.ec2_container_registry_readonly", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "/tf/IAM-Node-Groups.tf", "breadcrumbs": {"role": [{"type": "resource", "name": "aws_iam_role.eks_node_group_role", "path": "/tf/IAM-Node-Groups.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role": {"lbc_role": {"__end_line__": 20, "__start_line__": 1, "assume_role_policy": [{"Version": "2012-10-17", "Statement": [{"Action": ["sts:AssumeRole", "sts:TagSession"], "Effect": "Allow", "Sid": "", "Principal": {"Service": "pods.eks.amazonaws.com"}}]}], "name": ["lbc-role"], "__address__": "aws_iam_role.lbc_role"}}}, "evaluated_keys": ["arn", "managed_policy_arn", "name", "managed_policy_arns/*", "policy_arn"]}, "code_block": [[1, "resource \"aws_iam_role\" \"lbc_role\" {\n"], [2, "  name = \"lbc-role\"\n"], [3, "\n"], [4, "  assume_role_policy = jsonencode({\n"], [5, "    Version = \"2012-10-17\"\n"], [6, "    Statement = [\n"], [7, "      {\n"], [8, "        Action = [\n"], [9, "          \"sts:AssumeRole\",\n"], [10, "          \"sts:TagSession\"\n"], [11, "        ]\n"], [12, "        Effect = \"Allow\"\n"], [13, "        Sid    = \"\"\n"], [14, "        Principal = {\n"], [15, "          Service = \"pods.eks.amazonaws.com\"\n"], [16, "        }\n"], [17, "      }\n"], [18, "    ]\n"], [19, "  })\n"], [20, "}\n"]], "file_path": "/LBC-IAM.tf", "file_abs_path": "/tf/LBC-IAM.tf", "repo_file_path": "/tf/LBC-IAM.tf", "file_line_range": [1, 20], "resource": "aws_iam_role.lbc_role", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "/tf/LBC-IAM.tf"}, {"check_id": "CKV2_AWS_34", "bc_check_id": "BC_AWS_GENERAL_143", "check_name": "AWS SSM Parameter should be Encrypted", "check_result": {"result": "PASSED", "entity": {"aws_ssm_parameter": {"db_creds": {"__end_line__": 10, "__start_line__": 1, "name": ["prod/mongo/credentials"], "overwrite": [true], "type": ["SecureString"], "value": [{"MONGO_INITDB_ROOT_USERNAME": "yamldecode(file(\"path.module/variables.yaml\"))", "MONGO_INITDB_ROOT_PASSWORD": "local.secrets.MONGO_INITDB_ROOT_PASSWORD", "MONGO_INITDB_DATABASE": "local.secrets.MONGO_INITDB_DATABASE"}], "__address__": "aws_ssm_parameter.db_creds"}}}, "evaluated_keys": ["type"]}, "code_block": [[1, "resource \"aws_ssm_parameter\" \"db_creds\" {\n"], [2, "  name      = \"prod/mongo/credentials\"\n"], [3, "  type      = \"SecureString\"\n"], [4, "  overwrite = true\n"], [5, "  value     = jsonencode({\n"], [6, "    MONGO_INITDB_ROOT_USERNAME   = local.secrets.MONGO_INITDB_ROOT_USERNAME\n"], [7, "    MONGO_INITDB_ROOT_PASSWORD   = local.secrets.MONGO_INITDB_ROOT_PASSWORD\n"], [8, "    MONGO_INITDB_DATABASE        = local.secrets.MONGO_INITDB_DATABASE\n"], [9, "  })\n"], [10, "}\n"]], "file_path": "/paramter_store.tf", "file_abs_path": "/tf/paramter_store.tf", "repo_file_path": "/tf/paramter_store.tf", "file_line_range": [1, 10], "resource": "aws_ssm_parameter.db_creds", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-ssm-parameter-is-encrypted", "details": [], "check_len": null, "definition_context_file_path": "/tf/paramter_store.tf", "breadcrumbs": {"value": [{"type": "locals", "name": "secrets", "path": "/tf/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_34", "bc_check_id": "BC_AWS_GENERAL_143", "check_name": "AWS SSM Parameter should be Encrypted", "check_result": {"result": "PASSED", "entity": {"aws_ssm_parameter": {"back_creds": {"__end_line__": 22, "__start_line__": 12, "name": ["prod/back/credentials"], "overwrite": [true], "type": ["SecureString"], "value": [{"MONGO_URI": "mongodb://yamldecode(file(\"path.module/variables.yaml\")):local.secrets.MONGO_INITDB_ROOT_PASSWORD@db-svc:27017/local.secrets.MONGO_INITDB_DATABASE?authSource:admin", "PAYPAL_CLIENT_ID": "local.secrets.PAYPAL_CLIENT_ID", "PAYPAL_APP_SECRET": "local.secrets.PAYPAL_APP_SECRET", "JWT_SECRET": "local.secrets.JWT_SECRET"}], "__address__": "aws_ssm_parameter.back_creds"}}}, "evaluated_keys": ["type"]}, "code_block": [[12, "resource \"aws_ssm_parameter\" \"back_creds\" {\n"], [13, "  name      = \"prod/back/credentials\"\n"], [14, "  type      = \"SecureString\"\n"], [15, "  overwrite = true\n"], [16, "  value     = jsonencode({\n"], [17, "    MONGO_URI    = \"mongodb://${local.secrets.MONGO_INITDB_ROOT_USERNAME}:${local.secrets.MONGO_INITDB_ROOT_PASSWORD}@db-svc:27017/${local.secrets.MONGO_INITDB_DATABASE}?authSource=admin\"\n"], [18, "    PAYPAL_CLIENT_ID      = local.secrets.PAYPAL_CLIENT_ID\n"], [19, "    PAYPAL_APP_SECRET      = local.secrets.PAYPAL_APP_SECRET\n"], [20, "    JWT_SECRET  = local.secrets.JWT_SECRET\n"], [21, "  })\n"], [22, "}"]], "file_path": "/paramter_store.tf", "file_abs_path": "/tf/paramter_store.tf", "repo_file_path": "/tf/paramter_store.tf", "file_line_range": [12, 22], "resource": "aws_ssm_parameter.back_creds", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-ssm-parameter-is-encrypted", "details": [], "check_len": null, "definition_context_file_path": "/tf/paramter_store.tf", "breadcrumbs": {"value": [{"type": "locals", "name": "secrets", "path": "/tf/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_44", "bc_check_id": "BC_AWS_NETWORKING_80", "check_name": "Ensure AWS route table with VPC peering does not contain routes overly permissive to all traffic", "check_result": {"result": "PASSED", "entity": {"aws_route_table": {"public": {"__end_line__": 68, "__start_line__": 61, "route": [{"cidr_block": ["0.0.0.0/0"], "gateway_id": ["aws_internet_gateway.main.id"]}], "tags": [{"Name": "EKS-cluster-public-rt"}], "vpc_id": ["aws_vpc.main.id"], "__address__": "aws_route_table.public"}}}, "evaluated_keys": ["route/*/cidr_block", "destination_cidr_block", "route/*/vpc_peering_connection_id", "destination_ipv6_cidr_block", "route/*/ipv6_cidr_block", "vpc_peering_connection_id"]}, "code_block": [[61, "resource \"aws_route_table\" \"public\" {\n"], [62, "  vpc_id = aws_vpc.main.id\n"], [63, "  route {\n"], [64, "    cidr_block = \"0.0.0.0/0\"\n"], [65, "    gateway_id = aws_internet_gateway.main.id\n"], [66, "  }\n"], [67, "  tags = { Name = \"${var.cluster_name}-public-rt\" }\n"], [68, "}\n"]], "file_path": "/vpc.tf", "file_abs_path": "/tf/vpc.tf", "repo_file_path": "/tf/vpc.tf", "file_line_range": [61, 68], "resource": "aws_route_table.public", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "EKS-cluster-public-rt"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-route-table-with-vpc-peering-does-not-contain-routes-overly-permissive-to-all-traffic", "details": [], "check_len": null, "definition_context_file_path": "/tf/vpc.tf", "breadcrumbs": {"tags.Name": [{"type": "variable", "name": "cluster_name", "path": "/tf/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_44", "bc_check_id": "BC_AWS_NETWORKING_80", "check_name": "Ensure AWS route table with VPC peering does not contain routes overly permissive to all traffic", "check_result": {"result": "PASSED", "entity": {"aws_route_table": {"private": {"__end_line__": 77, "__start_line__": 70, "route": [{"cidr_block": ["0.0.0.0/0"], "nat_gateway_id": ["aws_nat_gateway.main.id"]}], "tags": [{"Name": "EKS-cluster-private-rt"}], "vpc_id": ["aws_vpc.main.id"], "__address__": "aws_route_table.private"}}}, "evaluated_keys": ["route/*/cidr_block", "destination_cidr_block", "route/*/vpc_peering_connection_id", "destination_ipv6_cidr_block", "route/*/ipv6_cidr_block", "vpc_peering_connection_id"]}, "code_block": [[70, "resource \"aws_route_table\" \"private\" {\n"], [71, "  vpc_id = aws_vpc.main.id\n"], [72, "  route {\n"], [73, "    cidr_block     = \"0.0.0.0/0\"\n"], [74, "    nat_gateway_id = aws_nat_gateway.main.id\n"], [75, "  }\n"], [76, "  tags = { Name = \"${var.cluster_name}-private-rt\" }\n"], [77, "}\n"]], "file_path": "/vpc.tf", "file_abs_path": "/tf/vpc.tf", "repo_file_path": "/tf/vpc.tf", "file_line_range": [70, 77], "resource": "aws_route_table.private", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "EKS-cluster-private-rt"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-route-table-with-vpc-peering-does-not-contain-routes-overly-permissive-to-all-traffic", "details": [], "check_len": null, "definition_context_file_path": "/tf/vpc.tf", "breadcrumbs": {"tags.Name": [{"type": "variable", "name": "cluster_name", "path": "/tf/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_35", "bc_check_id": "BC_AWS_NETWORKING_77", "check_name": "AWS NAT Gateways should be utilized for the default route", "check_result": {"result": "PASSED", "entity": {"aws_route_table": {"public": {"__end_line__": 68, "__start_line__": 61, "route": [{"cidr_block": ["0.0.0.0/0"], "gateway_id": ["aws_internet_gateway.main.id"]}], "tags": [{"Name": "EKS-cluster-public-rt"}], "vpc_id": ["aws_vpc.main.id"], "__address__": "aws_route_table.public"}}}, "evaluated_keys": ["destination_cidr_block", "route/*/cidr_block", "route/*/instance_id", "instance_id"]}, "code_block": [[61, "resource \"aws_route_table\" \"public\" {\n"], [62, "  vpc_id = aws_vpc.main.id\n"], [63, "  route {\n"], [64, "    cidr_block = \"0.0.0.0/0\"\n"], [65, "    gateway_id = aws_internet_gateway.main.id\n"], [66, "  }\n"], [67, "  tags = { Name = \"${var.cluster_name}-public-rt\" }\n"], [68, "}\n"]], "file_path": "/vpc.tf", "file_abs_path": "/tf/vpc.tf", "repo_file_path": "/tf/vpc.tf", "file_line_range": [61, 68], "resource": "aws_route_table.public", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "EKS-cluster-public-rt"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-nat-gateways-are-utilized-for-the-default-route", "details": [], "check_len": null, "definition_context_file_path": "/tf/vpc.tf", "breadcrumbs": {"tags.Name": [{"type": "variable", "name": "cluster_name", "path": "/tf/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_35", "bc_check_id": "BC_AWS_NETWORKING_77", "check_name": "AWS NAT Gateways should be utilized for the default route", "check_result": {"result": "PASSED", "entity": {"aws_route_table": {"private": {"__end_line__": 77, "__start_line__": 70, "route": [{"cidr_block": ["0.0.0.0/0"], "nat_gateway_id": ["aws_nat_gateway.main.id"]}], "tags": [{"Name": "EKS-cluster-private-rt"}], "vpc_id": ["aws_vpc.main.id"], "__address__": "aws_route_table.private"}}}, "evaluated_keys": ["destination_cidr_block", "route/*/cidr_block", "route/*/instance_id", "instance_id"]}, "code_block": [[70, "resource \"aws_route_table\" \"private\" {\n"], [71, "  vpc_id = aws_vpc.main.id\n"], [72, "  route {\n"], [73, "    cidr_block     = \"0.0.0.0/0\"\n"], [74, "    nat_gateway_id = aws_nat_gateway.main.id\n"], [75, "  }\n"], [76, "  tags = { Name = \"${var.cluster_name}-private-rt\" }\n"], [77, "}\n"]], "file_path": "/vpc.tf", "file_abs_path": "/tf/vpc.tf", "repo_file_path": "/tf/vpc.tf", "file_line_range": [70, 77], "resource": "aws_route_table.private", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "EKS-cluster-private-rt"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-nat-gateways-are-utilized-for-the-default-route", "details": [], "check_len": null, "definition_context_file_path": "/tf/vpc.tf", "breadcrumbs": {"tags.Name": [{"type": "variable", "name": "cluster_name", "path": "/tf/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_71", "bc_check_id": "BC_AWS_NETWORKING_95", "check_name": "Ensure AWS ACM Certificate domain name does not include wildcards", "check_result": {"result": "PASSED", "entity": {"aws_acm_certificate": {"users": {"__end_line__": 13, "__start_line__": 1, "domain_name": ["shebl22.me"], "lifecycle": [{"create_before_destroy": [true]}], "tags": [{"Environment": "production", "Name": "shebl22.me"}], "validation_method": ["DNS"], "__address__": "aws_acm_certificate.users"}}}, "evaluated_keys": ["subject_alternative_names/*", "domain_name", "subject_alternative_names"]}, "code_block": [[1, "resource \"aws_acm_certificate\" \"users\" {\n"], [2, "  domain_name       = var.users_domain\n"], [3, "  validation_method = \"DNS\"\n"], [4, "\n"], [5, "  lifecycle {\n"], [6, "    create_before_destroy = true\n"], [7, "  }\n"], [8, "\n"], [9, "  tags = {\n"], [10, "    Name        = var.users_domain\n"], [11, "    Environment = \"production\"\n"], [12, "  }\n"], [13, "}\n"]], "file_path": "/acm.tf", "file_abs_path": "/tf/acm.tf", "repo_file_path": "/tf/acm.tf", "file_line_range": [1, 13], "resource": "aws_acm_certificate.users", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "production", "Name": "shebl22.me"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-2-71", "details": [], "check_len": null, "definition_context_file_path": "/tf/acm.tf", "breadcrumbs": {"domain_name": [{"type": "variable", "name": "users_domain", "path": "/tf/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "users_domain", "path": "/tf/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_19", "bc_check_id": "BC_AWS_NETWORKING_48", "check_name": "Ensure that all EIP addresses allocated to a VPC are attached to EC2 instances", "check_result": {"result": "PASSED", "entity": {"aws_eip": {"nat": {"__end_line__": 50, "__start_line__": 45, "domain": ["vpc"], "tags": [{"Name": "EKS-cluster-nat-eip"}], "__address__": "aws_eip.nat"}}}, "evaluated_keys": ["instance", "domain", "instance_id", "resource_type", "vpc"]}, "code_block": [[45, "resource \"aws_eip\" \"nat\" {\n"], [46, "  # count      = length(var.private_subnets)\n"], [47, "  domain     = \"vpc\"\n"], [48, "  # depends_on = [aws_internet_gateway.main]\n"], [49, "  tags       = { Name = \"${var.cluster_name}-nat-eip\" }\n"], [50, "}\n"]], "file_path": "/vpc.tf", "file_abs_path": "/tf/vpc.tf", "repo_file_path": "/tf/vpc.tf", "file_line_range": [45, 50], "resource": "aws_eip.nat", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "EKS-cluster-nat-eip"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-all-eip-addresses-allocated-to-a-vpc-are-attached-to-ec2-instances", "details": [], "check_len": null, "definition_context_file_path": "/tf/vpc.tf", "breadcrumbs": {"tags.Name": [{"type": "variable", "name": "cluster_name", "path": "/tf/variables.tf", "module_connection": false}]}}], "failed_checks": [{"check_id": "CKV_AWS_58", "bc_check_id": "BC_AWS_KUBERNETES_3", "check_name": "Ensure EKS Cluster has Secrets Encryption Enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["encryption_config/[0]/resources"]}, "code_block": [[1, "resource \"aws_eks_cluster\" \"eks\" {\n"], [2, "  name     = var.cluster_name\n"], [3, "  version  = var.eks_version\n"], [4, "  role_arn = aws_iam_role.eks_cluster_role.arn \n"], [5, "\n"], [6, "  vpc_config {\n"], [7, "    endpoint_private_access = false\n"], [8, "    endpoint_public_access  = true\n"], [9, "    subnet_ids = aws_subnet.private[*].id\n"], [10, "  }\n"], [11, "\n"], [12, "\n"], [13, "  access_config {\n"], [14, "    authentication_mode                         = \"API\"\n"], [15, "    bootstrap_cluster_creator_admin_permissions = true\n"], [16, "  }\n"], [17, "\n"], [18, "  depends_on = [\n"], [19, "    aws_iam_role_policy_attachment.eks_cluster_policy\n"], [20, "  ]\n"], [21, "}\n"]], "file_path": "/EKS-cluster.tf", "file_abs_path": "/tf/EKS-cluster.tf", "repo_file_path": "/tf/EKS-cluster.tf", "file_line_range": [1, 21], "resource": "aws_eks_cluster.eks", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EKSSecretsEncryption", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-kubernetes-policies/bc-aws-kubernetes-3", "details": [], "check_len": null, "definition_context_file_path": "/tf/EKS-cluster.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "cluster_name", "path": "/tf/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_eks_cluster.eks", "path": "/tf/EKS-cluster.tf", "module_connection": false}], "version": [{"type": "variable", "name": "eks_version", "path": "/tf/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_339", "bc_check_id": "BC_AWS_KUBERNETES_6", "check_name": "Ensure EKS clusters run on a supported Kubernetes version", "check_result": {"result": "FAILED", "evaluated_keys": ["version"]}, "code_block": [[1, "resource \"aws_eks_cluster\" \"eks\" {\n"], [2, "  name     = var.cluster_name\n"], [3, "  version  = var.eks_version\n"], [4, "  role_arn = aws_iam_role.eks_cluster_role.arn \n"], [5, "\n"], [6, "  vpc_config {\n"], [7, "    endpoint_private_access = false\n"], [8, "    endpoint_public_access  = true\n"], [9, "    subnet_ids = aws_subnet.private[*].id\n"], [10, "  }\n"], [11, "\n"], [12, "\n"], [13, "  access_config {\n"], [14, "    authentication_mode                         = \"API\"\n"], [15, "    bootstrap_cluster_creator_admin_permissions = true\n"], [16, "  }\n"], [17, "\n"], [18, "  depends_on = [\n"], [19, "    aws_iam_role_policy_attachment.eks_cluster_policy\n"], [20, "  ]\n"], [21, "}\n"]], "file_path": "/EKS-cluster.tf", "file_abs_path": "/tf/EKS-cluster.tf", "repo_file_path": "/tf/EKS-cluster.tf", "file_line_range": [1, 21], "resource": "aws_eks_cluster.eks", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EKSPlatformVersion", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-kubernetes-policies/bc-aws-339", "details": [], "check_len": null, "definition_context_file_path": "/tf/EKS-cluster.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "cluster_name", "path": "/tf/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_eks_cluster.eks", "path": "/tf/EKS-cluster.tf", "module_connection": false}], "version": [{"type": "variable", "name": "eks_version", "path": "/tf/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_38", "bc_check_id": "BC_AWS_KUBERNETES_1", "check_name": "Ensure Amazon EKS public endpoint not accessible to 0.0.0.0/0", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[1, "resource \"aws_eks_cluster\" \"eks\" {\n"], [2, "  name     = var.cluster_name\n"], [3, "  version  = var.eks_version\n"], [4, "  role_arn = aws_iam_role.eks_cluster_role.arn \n"], [5, "\n"], [6, "  vpc_config {\n"], [7, "    endpoint_private_access = false\n"], [8, "    endpoint_public_access  = true\n"], [9, "    subnet_ids = aws_subnet.private[*].id\n"], [10, "  }\n"], [11, "\n"], [12, "\n"], [13, "  access_config {\n"], [14, "    authentication_mode                         = \"API\"\n"], [15, "    bootstrap_cluster_creator_admin_permissions = true\n"], [16, "  }\n"], [17, "\n"], [18, "  depends_on = [\n"], [19, "    aws_iam_role_policy_attachment.eks_cluster_policy\n"], [20, "  ]\n"], [21, "}\n"]], "file_path": "/EKS-cluster.tf", "file_abs_path": "/tf/EKS-cluster.tf", "repo_file_path": "/tf/EKS-cluster.tf", "file_line_range": [1, 21], "resource": "aws_eks_cluster.eks", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EKSPublicAccessCIDR", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-kubernetes-policies/bc-aws-kubernetes-1", "details": [], "check_len": null, "definition_context_file_path": "/tf/EKS-cluster.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "cluster_name", "path": "/tf/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_eks_cluster.eks", "path": "/tf/EKS-cluster.tf", "module_connection": false}], "version": [{"type": "variable", "name": "eks_version", "path": "/tf/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_39", "bc_check_id": "BC_AWS_KUBERNETES_2", "check_name": "Ensure Amazon EKS public endpoint disabled", "check_result": {"result": "FAILED", "evaluated_keys": ["vpc_config/[0]/endpoint_public_access"]}, "code_block": [[1, "resource \"aws_eks_cluster\" \"eks\" {\n"], [2, "  name     = var.cluster_name\n"], [3, "  version  = var.eks_version\n"], [4, "  role_arn = aws_iam_role.eks_cluster_role.arn \n"], [5, "\n"], [6, "  vpc_config {\n"], [7, "    endpoint_private_access = false\n"], [8, "    endpoint_public_access  = true\n"], [9, "    subnet_ids = aws_subnet.private[*].id\n"], [10, "  }\n"], [11, "\n"], [12, "\n"], [13, "  access_config {\n"], [14, "    authentication_mode                         = \"API\"\n"], [15, "    bootstrap_cluster_creator_admin_permissions = true\n"], [16, "  }\n"], [17, "\n"], [18, "  depends_on = [\n"], [19, "    aws_iam_role_policy_attachment.eks_cluster_policy\n"], [20, "  ]\n"], [21, "}\n"]], "file_path": "/EKS-cluster.tf", "file_abs_path": "/tf/EKS-cluster.tf", "repo_file_path": "/tf/EKS-cluster.tf", "file_line_range": [1, 21], "resource": "aws_eks_cluster.eks", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EKSPublicAccess", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-kubernetes-policies/bc-aws-kubernetes-2", "details": [], "check_len": null, "definition_context_file_path": "/tf/EKS-cluster.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "cluster_name", "path": "/tf/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_eks_cluster.eks", "path": "/tf/EKS-cluster.tf", "module_connection": false}], "version": [{"type": "variable", "name": "eks_version", "path": "/tf/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_37", "bc_check_id": "BC_AWS_KUBERNETES_4", "check_name": "Ensure Amazon EKS control plane logging is enabled for all log types", "check_result": {"result": "FAILED", "evaluated_keys": ["enabled_cluster_log_types"]}, "code_block": [[1, "resource \"aws_eks_cluster\" \"eks\" {\n"], [2, "  name     = var.cluster_name\n"], [3, "  version  = var.eks_version\n"], [4, "  role_arn = aws_iam_role.eks_cluster_role.arn \n"], [5, "\n"], [6, "  vpc_config {\n"], [7, "    endpoint_private_access = false\n"], [8, "    endpoint_public_access  = true\n"], [9, "    subnet_ids = aws_subnet.private[*].id\n"], [10, "  }\n"], [11, "\n"], [12, "\n"], [13, "  access_config {\n"], [14, "    authentication_mode                         = \"API\"\n"], [15, "    bootstrap_cluster_creator_admin_permissions = true\n"], [16, "  }\n"], [17, "\n"], [18, "  depends_on = [\n"], [19, "    aws_iam_role_policy_attachment.eks_cluster_policy\n"], [20, "  ]\n"], [21, "}\n"]], "file_path": "/EKS-cluster.tf", "file_abs_path": "/tf/EKS-cluster.tf", "repo_file_path": "/tf/EKS-cluster.tf", "file_line_range": [1, 21], "resource": "aws_eks_cluster.eks", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EKSControlPlaneLogging", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-kubernetes-policies/bc-aws-kubernetes-4", "details": [], "check_len": null, "definition_context_file_path": "/tf/EKS-cluster.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "cluster_name", "path": "/tf/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_eks_cluster.eks", "path": "/tf/EKS-cluster.tf", "module_connection": false}], "version": [{"type": "variable", "name": "eks_version", "path": "/tf/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_337", "bc_check_id": "BC_AWS_GENERAL_242", "check_name": "Ensure SSM parameters are using KMS CMK", "check_result": {"result": "FAILED", "evaluated_keys": ["key_id"]}, "code_block": [[1, "resource \"aws_ssm_parameter\" \"db_creds\" {\n"], [2, "  name      = \"prod/mongo/credentials\"\n"], [3, "  type      = \"SecureString\"\n"], [4, "  overwrite = true\n"], [5, "  value     = jsonencode({\n"], [6, "    MONGO_INITDB_ROOT_USERNAME   = local.secrets.MONGO_INITDB_ROOT_USERNAME\n"], [7, "    MONGO_INITDB_ROOT_PASSWORD   = local.secrets.MONGO_INITDB_ROOT_PASSWORD\n"], [8, "    MONGO_INITDB_DATABASE        = local.secrets.MONGO_INITDB_DATABASE\n"], [9, "  })\n"], [10, "}\n"]], "file_path": "/paramter_store.tf", "file_abs_path": "/tf/paramter_store.tf", "repo_file_path": "/tf/paramter_store.tf", "file_line_range": [1, 10], "resource": "aws_ssm_parameter.db_creds", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SSMParameterUsesCMK", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-337", "details": [], "check_len": null, "definition_context_file_path": "/tf/paramter_store.tf", "breadcrumbs": {"value": [{"type": "locals", "name": "secrets", "path": "/tf/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_337", "bc_check_id": "BC_AWS_GENERAL_242", "check_name": "Ensure SSM parameters are using KMS CMK", "check_result": {"result": "FAILED", "evaluated_keys": ["key_id"]}, "code_block": [[12, "resource \"aws_ssm_parameter\" \"back_creds\" {\n"], [13, "  name      = \"prod/back/credentials\"\n"], [14, "  type      = \"SecureString\"\n"], [15, "  overwrite = true\n"], [16, "  value     = jsonencode({\n"], [17, "    MONGO_URI    = \"mongodb://${local.secrets.MONGO_INITDB_ROOT_USERNAME}:${local.secrets.MONGO_INITDB_ROOT_PASSWORD}@db-svc:27017/${local.secrets.MONGO_INITDB_DATABASE}?authSource=admin\"\n"], [18, "    PAYPAL_CLIENT_ID      = local.secrets.PAYPAL_CLIENT_ID\n"], [19, "    PAYPAL_APP_SECRET      = local.secrets.PAYPAL_APP_SECRET\n"], [20, "    JWT_SECRET  = local.secrets.JWT_SECRET\n"], [21, "  })\n"], [22, "}"]], "file_path": "/paramter_store.tf", "file_abs_path": "/tf/paramter_store.tf", "repo_file_path": "/tf/paramter_store.tf", "file_line_range": [12, 22], "resource": "aws_ssm_parameter.back_creds", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SSMParameterUsesCMK", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-337", "details": [], "check_len": null, "definition_context_file_path": "/tf/paramter_store.tf", "breadcrumbs": {"value": [{"type": "locals", "name": "secrets", "path": "/tf/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_130", "bc_check_id": "BC_AWS_NETWORKING_53", "check_name": "Ensure VPC subnets do not assign public IP by default", "check_result": {"result": "FAILED", "evaluated_keys": ["map_public_ip_on_launch"]}, "code_block": [[11, "resource \"aws_subnet\" \"public\" {\n"], [12, "  count = length(var.public_subnets)\n"], [13, "\n"], [14, "  vpc_id                  = aws_vpc.main.id\n"], [15, "  cidr_block              = var.public_subnets[count.index]\n"], [16, "  availability_zone       = element(data.aws_availability_zones.available.names, count.index)\n"], [17, "  map_public_ip_on_launch = true\n"], [18, "\n"], [19, "  tags = {\n"], [20, "    Name                                        = \"${var.cluster_name}-public-subnet-${count.index + 1}\"\n"], [21, "    \"kubernetes.io/cluster/${var.cluster_name}\" = \"shared\"\n"], [22, "    \"kubernetes.io/role/elb\"                    = \"1\" # For public/internet-facing load balancers\n"], [23, "  }\n"], [24, "}\n"]], "file_path": "/vpc.tf", "file_abs_path": "/tf/vpc.tf", "repo_file_path": "/tf/vpc.tf", "file_line_range": [11, 24], "resource": "aws_subnet.public[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SubnetPublicIP", "fixed_definition": null, "entity_tags": {"Name": "EKS-cluster-public-subnet-${0 + 1}", "kubernetes.io/cluster/${var.cluster_name}": "shared", "kubernetes.io/role/elb": "1"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default", "details": [], "check_len": null, "definition_context_file_path": "/tf/vpc.tf", "breadcrumbs": {"tags.Name": [{"type": "variable", "name": "cluster_name", "path": "/tf/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_130", "bc_check_id": "BC_AWS_NETWORKING_53", "check_name": "Ensure VPC subnets do not assign public IP by default", "check_result": {"result": "FAILED", "evaluated_keys": ["map_public_ip_on_launch"]}, "code_block": [[11, "resource \"aws_subnet\" \"public\" {\n"], [12, "  count = length(var.public_subnets)\n"], [13, "\n"], [14, "  vpc_id                  = aws_vpc.main.id\n"], [15, "  cidr_block              = var.public_subnets[count.index]\n"], [16, "  availability_zone       = element(data.aws_availability_zones.available.names, count.index)\n"], [17, "  map_public_ip_on_launch = true\n"], [18, "\n"], [19, "  tags = {\n"], [20, "    Name                                        = \"${var.cluster_name}-public-subnet-${count.index + 1}\"\n"], [21, "    \"kubernetes.io/cluster/${var.cluster_name}\" = \"shared\"\n"], [22, "    \"kubernetes.io/role/elb\"                    = \"1\" # For public/internet-facing load balancers\n"], [23, "  }\n"], [24, "}\n"]], "file_path": "/vpc.tf", "file_abs_path": "/tf/vpc.tf", "repo_file_path": "/tf/vpc.tf", "file_line_range": [11, 24], "resource": "aws_subnet.public[1]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SubnetPublicIP", "fixed_definition": null, "entity_tags": {"Name": "EKS-cluster-public-subnet-${1 + 1}", "kubernetes.io/cluster/${var.cluster_name}": "shared", "kubernetes.io/role/elb": "1"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default", "details": [], "check_len": null, "definition_context_file_path": "/tf/vpc.tf", "breadcrumbs": {"tags.Name": [{"type": "variable", "name": "cluster_name", "path": "/tf/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_12", "bc_check_id": "BC_AWS_NETWORKING_4", "check_name": "Ensure the default security group of every VPC restricts all traffic", "check_result": {"result": "FAILED", "entity": {"aws_vpc": {"main": {"__end_line__": 9, "__start_line__": 1, "cidr_block": ["10.0.0.0/16"], "tags": [{"Name": "EKS-cluster-vpc"}], "__address__": "aws_vpc.main"}}}, "evaluated_keys": ["egress/protocol", "egress/to_port", "ingress/self", "egress/cidr_blocks", "resource_type", "egress/from_port", "ingress/to_port", "ingress/protocol", "ingress/from_port"]}, "code_block": [[1, "resource \"aws_vpc\" \"main\" {\n"], [2, "  cidr_block           = var.vpc_cidr\n"], [3, "  # enable_dns_hostnames = true\n"], [4, "  # enable_dns_support   = true\n"], [5, "\n"], [6, "  tags = {\n"], [7, "    Name = \"${var.cluster_name}-vpc\"\n"], [8, "  }\n"], [9, "}\n"]], "file_path": "/vpc.tf", "file_abs_path": "/tf/vpc.tf", "repo_file_path": "/tf/vpc.tf", "file_line_range": [1, 9], "resource": "aws_vpc.main", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "EKS-cluster-vpc"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-4", "details": [], "check_len": null, "definition_context_file_path": "/tf/vpc.tf", "breadcrumbs": {"tags.Name": [{"type": "variable", "name": "cluster_name", "path": "/tf/variables.tf", "module_connection": false}], "cidr_block": [{"type": "variable", "name": "vpc_cidr", "path": "/tf/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_11", "bc_check_id": "BC_AWS_LOGGING_9", "check_name": "Ensure VPC flow logging is enabled in all VPCs", "check_result": {"result": "FAILED", "entity": {"aws_vpc": {"main": {"__end_line__": 9, "__start_line__": 1, "cidr_block": ["10.0.0.0/16"], "tags": [{"Name": "EKS-cluster-vpc"}], "__address__": "aws_vpc.main"}}}, "evaluated_keys": ["networking", "resource_type"]}, "code_block": [[1, "resource \"aws_vpc\" \"main\" {\n"], [2, "  cidr_block           = var.vpc_cidr\n"], [3, "  # enable_dns_hostnames = true\n"], [4, "  # enable_dns_support   = true\n"], [5, "\n"], [6, "  tags = {\n"], [7, "    Name = \"${var.cluster_name}-vpc\"\n"], [8, "  }\n"], [9, "}\n"]], "file_path": "/vpc.tf", "file_abs_path": "/tf/vpc.tf", "repo_file_path": "/tf/vpc.tf", "file_line_range": [1, 9], "resource": "aws_vpc.main", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "EKS-cluster-vpc"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-9-enable-vpc-flow-logging", "details": [], "check_len": null, "definition_context_file_path": "/tf/vpc.tf", "breadcrumbs": {"tags.Name": [{"type": "variable", "name": "cluster_name", "path": "/tf/variables.tf", "module_connection": false}], "cidr_block": [{"type": "variable", "name": "vpc_cidr", "path": "/tf/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_38", "bc_check_id": "BC_AWS_NETWORKING_83", "check_name": "Ensure Domain Name System Security Extensions (DNSSEC) signing is enabled for Amazon Route 53 public hosted zones", "check_result": {"result": "FAILED", "entity": {"aws_route53_zone": {"admin_panel": {"__end_line__": 7, "__start_line__": 1, "name": ["shebl22vip.tech"], "tags": [{"Name": "admin panel Domain"}], "__address__": "aws_route53_zone.admin_panel"}}}, "evaluated_keys": ["resource_type", "vpc"]}, "code_block": [[1, "resource \"aws_route53_zone\" \"admin_panel\" {\n"], [2, "  name = var.panel_domain\n"], [3, "  \n"], [4, "  tags = {\n"], [5, "    Name = \"admin panel Domain\"\n"], [6, "  }\n"], [7, "}\n"]], "file_path": "/route53.tf", "file_abs_path": "/tf/route53.tf", "repo_file_path": "/tf/route53.tf", "file_line_range": [1, 7], "resource": "aws_route53_zone.admin_panel", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "admin panel Domain"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-2-38", "details": [], "check_len": null, "definition_context_file_path": "/tf/route53.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "panel_domain", "path": "/tf/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_38", "bc_check_id": "BC_AWS_NETWORKING_83", "check_name": "Ensure Domain Name System Security Extensions (DNSSEC) signing is enabled for Amazon Route 53 public hosted zones", "check_result": {"result": "FAILED", "entity": {"aws_route53_zone": {"users_domain": {"__end_line__": 16, "__start_line__": 10, "name": ["shebl22.me"], "tags": [{"Name": "users domain Domain"}], "__address__": "aws_route53_zone.users_domain"}}}, "evaluated_keys": ["resource_type", "vpc"]}, "code_block": [[10, "resource \"aws_route53_zone\" \"users_domain\" {\n"], [11, "  name = var.users_domain\n"], [12, "  \n"], [13, "  tags = {\n"], [14, "    Name = \"users domain Domain\"\n"], [15, "  }\n"], [16, "}\n"]], "file_path": "/route53.tf", "file_abs_path": "/tf/route53.tf", "repo_file_path": "/tf/route53.tf", "file_line_range": [10, 16], "resource": "aws_route53_zone.users_domain", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "users domain Domain"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-2-38", "details": [], "check_len": null, "definition_context_file_path": "/tf/route53.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "users_domain", "path": "/tf/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_39", "bc_check_id": "BC_AWS_LOGGING_34", "check_name": "Ensure Domain Name System (DNS) query logging is enabled for Amazon Route 53 hosted zones", "check_result": {"result": "FAILED", "entity": {"aws_route53_zone": {"admin_panel": {"__end_line__": 7, "__start_line__": 1, "name": ["shebl22vip.tech"], "tags": [{"Name": "admin panel Domain"}], "__address__": "aws_route53_zone.admin_panel"}}}, "evaluated_keys": ["resource_type", "vpc"]}, "code_block": [[1, "resource \"aws_route53_zone\" \"admin_panel\" {\n"], [2, "  name = var.panel_domain\n"], [3, "  \n"], [4, "  tags = {\n"], [5, "    Name = \"admin panel Domain\"\n"], [6, "  }\n"], [7, "}\n"]], "file_path": "/route53.tf", "file_abs_path": "/tf/route53.tf", "repo_file_path": "/tf/route53.tf", "file_line_range": [1, 7], "resource": "aws_route53_zone.admin_panel", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "admin panel Domain"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-39", "details": [], "check_len": null, "definition_context_file_path": "/tf/route53.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "panel_domain", "path": "/tf/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_39", "bc_check_id": "BC_AWS_LOGGING_34", "check_name": "Ensure Domain Name System (DNS) query logging is enabled for Amazon Route 53 hosted zones", "check_result": {"result": "FAILED", "entity": {"aws_route53_zone": {"users_domain": {"__end_line__": 16, "__start_line__": 10, "name": ["shebl22.me"], "tags": [{"Name": "users domain Domain"}], "__address__": "aws_route53_zone.users_domain"}}}, "evaluated_keys": ["resource_type", "vpc"]}, "code_block": [[10, "resource \"aws_route53_zone\" \"users_domain\" {\n"], [11, "  name = var.users_domain\n"], [12, "  \n"], [13, "  tags = {\n"], [14, "    Name = \"users domain Domain\"\n"], [15, "  }\n"], [16, "}\n"]], "file_path": "/route53.tf", "file_abs_path": "/tf/route53.tf", "repo_file_path": "/tf/route53.tf", "file_line_range": [10, 16], "resource": "aws_route53_zone.users_domain", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "users domain Domain"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-39", "details": [], "check_len": null, "definition_context_file_path": "/tf/route53.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "users_domain", "path": "/tf/variables.tf", "module_connection": false}]}}], "skipped_checks": [], "parsing_errors": []}, "summary": {"passed": 57, "failed": 15, "skipped": 0, "parsing_errors": 0, "resource_count": 47, "checkov_version": "3.2.493"}, "url": "Add an api key '--bc-api-key <api-key>' to see more detailed insights via https://bridgecrew.cloud"}