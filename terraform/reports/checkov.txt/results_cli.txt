terraform scan results:

Passed checks: 57, Failed checks: 15, Skipped checks: 0

Check: CKV_AWS_60: "Ensure IAM role allows only specific services or principals to assume it"
	PASSED for resource: aws_iam_role.ebs_role
	File: /EBS-IAM.tf:1-23
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44
Check: CKV_AWS_274: "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy"
	PASSED for resource: aws_iam_role.ebs_role
	File: /EBS-IAM.tf:1-23
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274
Check: CKV_AWS_61: "Ensure AWS IAM policy does not allow assume role permission across all services"
	PASSED for resource: aws_iam_role.ebs_role
	File: /EBS-IAM.tf:1-23
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45
Check: CKV_AWS_274: "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy"
	PASSED for resource: aws_iam_role_policy_attachment.ebs-attach
	File: /EBS-IAM.tf:26-29
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274
Check: CKV_AWS_60: "Ensure IAM role allows only specific services or principals to assume it"
	PASSED for resource: aws_iam_role.edns_role
	File: /EDNS-IAM.tf:1-23
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44
Check: CKV_AWS_274: "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy"
	PASSED for resource: aws_iam_role.edns_role
	File: /EDNS-IAM.tf:1-23
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274
Check: CKV_AWS_61: "Ensure AWS IAM policy does not allow assume role permission across all services"
	PASSED for resource: aws_iam_role.edns_role
	File: /EDNS-IAM.tf:1-23
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45
Check: CKV_AWS_62: "Ensure IAM policies that allow full "*-*" administrative privileges are not created"
	PASSED for resource: aws_iam_policy.edns-policy
	File: /EDNS-IAM.tf:24-28
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45
Check: CKV_AWS_63: "Ensure no IAM policies documents allow "*" as a statement's actions"
	PASSED for resource: aws_iam_policy.edns-policy
	File: /EDNS-IAM.tf:24-28
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/iam-48
Check: CKV_AWS_274: "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy"
	PASSED for resource: aws_iam_role_policy_attachment.edns-attach
	File: /EDNS-IAM.tf:29-32
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274
Check: CKV_AWS_100: "Ensure AWS EKS node group does not have implicit SSH access from 0.0.0.0/0"
	PASSED for resource: aws_eks_node_group.eks_node_group
	File: /EKS-NodeGroups.tf:1-36
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-kubernetes-policies/bc-aws-kubernetes-5
Check: CKV_AWS_60: "Ensure IAM role allows only specific services or principals to assume it"
	PASSED for resource: aws_iam_role.eso
	File: /ESO-IAM.tf:1-20
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44
Check: CKV_AWS_274: "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy"
	PASSED for resource: aws_iam_role.eso
	File: /ESO-IAM.tf:1-20
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274
Check: CKV_AWS_61: "Ensure AWS IAM policy does not allow assume role permission across all services"
	PASSED for resource: aws_iam_role.eso
	File: /ESO-IAM.tf:1-20
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45
Check: CKV_AWS_62: "Ensure IAM policies that allow full "*-*" administrative privileges are not created"
	PASSED for resource: aws_iam_policy.eso-policy
	File: /ESO-IAM.tf:22-26
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45
Check: CKV_AWS_63: "Ensure no IAM policies documents allow "*" as a statement's actions"
	PASSED for resource: aws_iam_policy.eso-policy
	File: /ESO-IAM.tf:22-26
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/iam-48
Check: CKV_AWS_274: "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy"
	PASSED for resource: aws_iam_role_policy_attachment.eso-attach
	File: /ESO-IAM.tf:28-31
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274
Check: CKV_AWS_60: "Ensure IAM role allows only specific services or principals to assume it"
	PASSED for resource: aws_iam_role.eks_cluster_role
	File: /IAM-EKS.tf:1-7
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44
Check: CKV_AWS_274: "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy"
	PASSED for resource: aws_iam_role.eks_cluster_role
	File: /IAM-EKS.tf:1-7
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274
Check: CKV_AWS_61: "Ensure AWS IAM policy does not allow assume role permission across all services"
	PASSED for resource: aws_iam_role.eks_cluster_role
	File: /IAM-EKS.tf:1-7
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45
Check: CKV_AWS_274: "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy"
	PASSED for resource: aws_iam_role_policy_attachment.eks_cluster_policy
	File: /IAM-EKS.tf:9-12
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274
Check: CKV_AWS_60: "Ensure IAM role allows only specific services or principals to assume it"
	PASSED for resource: aws_iam_role.eks_node_group_role
	File: /IAM-Node-Groups.tf:2-8
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44
Check: CKV_AWS_274: "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy"
	PASSED for resource: aws_iam_role.eks_node_group_role
	File: /IAM-Node-Groups.tf:2-8
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274
Check: CKV_AWS_61: "Ensure AWS IAM policy does not allow assume role permission across all services"
	PASSED for resource: aws_iam_role.eks_node_group_role
	File: /IAM-Node-Groups.tf:2-8
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45
Check: CKV_AWS_274: "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy"
	PASSED for resource: aws_iam_role_policy_attachment.eks_worker_node_policy
	File: /IAM-Node-Groups.tf:10-13
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274
Check: CKV_AWS_274: "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy"
	PASSED for resource: aws_iam_role_policy_attachment.eks_cni_policy
	File: /IAM-Node-Groups.tf:15-18
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274
Check: CKV_AWS_274: "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy"
	PASSED for resource: aws_iam_role_policy_attachment.ec2_container_registry_readonly
	File: /IAM-Node-Groups.tf:20-23
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274
Check: CKV_AWS_60: "Ensure IAM role allows only specific services or principals to assume it"
	PASSED for resource: aws_iam_role.lbc_role
	File: /LBC-IAM.tf:1-20
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44
Check: CKV_AWS_274: "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy"
	PASSED for resource: aws_iam_role.lbc_role
	File: /LBC-IAM.tf:1-20
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274
Check: CKV_AWS_61: "Ensure AWS IAM policy does not allow assume role permission across all services"
	PASSED for resource: aws_iam_role.lbc_role
	File: /LBC-IAM.tf:1-20
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45
Check: CKV_AWS_62: "Ensure IAM policies that allow full "*-*" administrative privileges are not created"
	PASSED for resource: aws_iam_policy.lbc_policy
	File: /LBC-IAM.tf:22-25
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45
Check: CKV_AWS_63: "Ensure no IAM policies documents allow "*" as a statement's actions"
	PASSED for resource: aws_iam_policy.lbc_policy
	File: /LBC-IAM.tf:22-25
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/iam-48
Check: CKV_AWS_274: "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy"
	PASSED for resource: aws_iam_role_policy_attachment.lbc_attach
	File: /LBC-IAM.tf:27-30
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274
Check: CKV_AWS_234: "Verify logging preference for ACM certificates"
	PASSED for resource: aws_acm_certificate.users
	File: /acm.tf:1-13
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-acm-certificates-has-logging-preference
Check: CKV_AWS_233: "Ensure Create before destroy for ACM certificates"
	PASSED for resource: aws_acm_certificate.users
	File: /acm.tf:1-13
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-acm-certificate-enables-create-before-destroy
Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /providers.tf:24-26
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-5
Check: CKV_AWS_130: "Ensure VPC subnets do not assign public IP by default"
	PASSED for resource: aws_subnet.private[0]
	File: /vpc.tf:26-38
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default
Check: CKV_AWS_130: "Ensure VPC subnets do not assign public IP by default"
	PASSED for resource: aws_subnet.private[1]
	File: /vpc.tf:26-38
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default
Check: CKV2_AWS_56: "Ensure AWS Managed IAMFullAccess IAM policy is not used."
	PASSED for resource: aws_iam_role.ebs_role
	File: /EBS-IAM.tf:1-23
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56
Check: CKV2_AWS_56: "Ensure AWS Managed IAMFullAccess IAM policy is not used."
	PASSED for resource: aws_iam_role_policy_attachment.ebs-attach
	File: /EBS-IAM.tf:26-29
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56
Check: CKV2_AWS_56: "Ensure AWS Managed IAMFullAccess IAM policy is not used."
	PASSED for resource: aws_iam_role.edns_role
	File: /EDNS-IAM.tf:1-23
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56
Check: CKV2_AWS_56: "Ensure AWS Managed IAMFullAccess IAM policy is not used."
	PASSED for resource: aws_iam_role.eso
	File: /ESO-IAM.tf:1-20
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56
Check: CKV2_AWS_56: "Ensure AWS Managed IAMFullAccess IAM policy is not used."
	PASSED for resource: aws_iam_role.eks_cluster_role
	File: /IAM-EKS.tf:1-7
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56
Check: CKV2_AWS_56: "Ensure AWS Managed IAMFullAccess IAM policy is not used."
	PASSED for resource: aws_iam_role_policy_attachment.eks_cluster_policy
	File: /IAM-EKS.tf:9-12
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56
Check: CKV2_AWS_56: "Ensure AWS Managed IAMFullAccess IAM policy is not used."
	PASSED for resource: aws_iam_role.eks_node_group_role
	File: /IAM-Node-Groups.tf:2-8
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56
Check: CKV2_AWS_56: "Ensure AWS Managed IAMFullAccess IAM policy is not used."
	PASSED for resource: aws_iam_role_policy_attachment.eks_worker_node_policy
	File: /IAM-Node-Groups.tf:10-13
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56
Check: CKV2_AWS_56: "Ensure AWS Managed IAMFullAccess IAM policy is not used."
	PASSED for resource: aws_iam_role_policy_attachment.eks_cni_policy
	File: /IAM-Node-Groups.tf:15-18
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56
Check: CKV2_AWS_56: "Ensure AWS Managed IAMFullAccess IAM policy is not used."
	PASSED for resource: aws_iam_role_policy_attachment.ec2_container_registry_readonly
	File: /IAM-Node-Groups.tf:20-23
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56
Check: CKV2_AWS_56: "Ensure AWS Managed IAMFullAccess IAM policy is not used."
	PASSED for resource: aws_iam_role.lbc_role
	File: /LBC-IAM.tf:1-20
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56
Check: CKV2_AWS_34: "AWS SSM Parameter should be Encrypted"
	PASSED for resource: aws_ssm_parameter.db_creds
	File: /paramter_store.tf:1-10
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-ssm-parameter-is-encrypted
Check: CKV2_AWS_34: "AWS SSM Parameter should be Encrypted"
	PASSED for resource: aws_ssm_parameter.back_creds
	File: /paramter_store.tf:12-22
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-ssm-parameter-is-encrypted
Check: CKV2_AWS_44: "Ensure AWS route table with VPC peering does not contain routes overly permissive to all traffic"
	PASSED for resource: aws_route_table.public
	File: /vpc.tf:61-68
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-route-table-with-vpc-peering-does-not-contain-routes-overly-permissive-to-all-traffic
Check: CKV2_AWS_44: "Ensure AWS route table with VPC peering does not contain routes overly permissive to all traffic"
	PASSED for resource: aws_route_table.private
	File: /vpc.tf:70-77
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-route-table-with-vpc-peering-does-not-contain-routes-overly-permissive-to-all-traffic
Check: CKV2_AWS_19: "Ensure that all EIP addresses allocated to a VPC are attached to EC2 instances"
	PASSED for resource: aws_eip.nat
	File: /vpc.tf:45-50
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-all-eip-addresses-allocated-to-a-vpc-are-attached-to-ec2-instances
Check: CKV2_AWS_35: "AWS NAT Gateways should be utilized for the default route"
	PASSED for resource: aws_route_table.public
	File: /vpc.tf:61-68
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-nat-gateways-are-utilized-for-the-default-route
Check: CKV2_AWS_35: "AWS NAT Gateways should be utilized for the default route"
	PASSED for resource: aws_route_table.private
	File: /vpc.tf:70-77
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-nat-gateways-are-utilized-for-the-default-route
Check: CKV2_AWS_71: "Ensure AWS ACM Certificate domain name does not include wildcards"
	PASSED for resource: aws_acm_certificate.users
	File: /acm.tf:1-13
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-2-71
Check: CKV_AWS_58: "Ensure EKS Cluster has Secrets Encryption Enabled"
	FAILED for resource: aws_eks_cluster.eks
	File: /EKS-cluster.tf:1-21
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-kubernetes-policies/bc-aws-kubernetes-3

		1  | resource "aws_eks_cluster" "eks" {
		2  |   name     = var.cluster_name
		3  |   version  = var.eks_version
		4  |   role_arn = aws_iam_role.eks_cluster_role.arn 
		5  | 
		6  |   vpc_config {
		7  |     endpoint_private_access = false
		8  |     endpoint_public_access  = true
		9  |     subnet_ids = aws_subnet.private[*].id
		10 |   }
		11 | 
		12 | 
		13 |   access_config {
		14 |     authentication_mode                         = "API"
		15 |     bootstrap_cluster_creator_admin_permissions = true
		16 |   }
		17 | 
		18 |   depends_on = [
		19 |     aws_iam_role_policy_attachment.eks_cluster_policy
		20 |   ]
		21 | }

Check: CKV_AWS_339: "Ensure EKS clusters run on a supported Kubernetes version"
	FAILED for resource: aws_eks_cluster.eks
	File: /EKS-cluster.tf:1-21
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-kubernetes-policies/bc-aws-339

		1  | resource "aws_eks_cluster" "eks" {
		2  |   name     = var.cluster_name
		3  |   version  = var.eks_version
		4  |   role_arn = aws_iam_role.eks_cluster_role.arn 
		5  | 
		6  |   vpc_config {
		7  |     endpoint_private_access = false
		8  |     endpoint_public_access  = true
		9  |     subnet_ids = aws_subnet.private[*].id
		10 |   }
		11 | 
		12 | 
		13 |   access_config {
		14 |     authentication_mode                         = "API"
		15 |     bootstrap_cluster_creator_admin_permissions = true
		16 |   }
		17 | 
		18 |   depends_on = [
		19 |     aws_iam_role_policy_attachment.eks_cluster_policy
		20 |   ]
		21 | }

Check: CKV_AWS_38: "Ensure Amazon EKS public endpoint not accessible to 0.0.0.0/0"
	FAILED for resource: aws_eks_cluster.eks
	File: /EKS-cluster.tf:1-21
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-kubernetes-policies/bc-aws-kubernetes-1

		1  | resource "aws_eks_cluster" "eks" {
		2  |   name     = var.cluster_name
		3  |   version  = var.eks_version
		4  |   role_arn = aws_iam_role.eks_cluster_role.arn 
		5  | 
		6  |   vpc_config {
		7  |     endpoint_private_access = false
		8  |     endpoint_public_access  = true
		9  |     subnet_ids = aws_subnet.private[*].id
		10 |   }
		11 | 
		12 | 
		13 |   access_config {
		14 |     authentication_mode                         = "API"
		15 |     bootstrap_cluster_creator_admin_permissions = true
		16 |   }
		17 | 
		18 |   depends_on = [
		19 |     aws_iam_role_policy_attachment.eks_cluster_policy
		20 |   ]
		21 | }

Check: CKV_AWS_39: "Ensure Amazon EKS public endpoint disabled"
	FAILED for resource: aws_eks_cluster.eks
	File: /EKS-cluster.tf:1-21
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-kubernetes-policies/bc-aws-kubernetes-2

		1  | resource "aws_eks_cluster" "eks" {
		2  |   name     = var.cluster_name
		3  |   version  = var.eks_version
		4  |   role_arn = aws_iam_role.eks_cluster_role.arn 
		5  | 
		6  |   vpc_config {
		7  |     endpoint_private_access = false
		8  |     endpoint_public_access  = true
		9  |     subnet_ids = aws_subnet.private[*].id
		10 |   }
		11 | 
		12 | 
		13 |   access_config {
		14 |     authentication_mode                         = "API"
		15 |     bootstrap_cluster_creator_admin_permissions = true
		16 |   }
		17 | 
		18 |   depends_on = [
		19 |     aws_iam_role_policy_attachment.eks_cluster_policy
		20 |   ]
		21 | }

Check: CKV_AWS_37: "Ensure Amazon EKS control plane logging is enabled for all log types"
	FAILED for resource: aws_eks_cluster.eks
	File: /EKS-cluster.tf:1-21
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-kubernetes-policies/bc-aws-kubernetes-4

		1  | resource "aws_eks_cluster" "eks" {
		2  |   name     = var.cluster_name
		3  |   version  = var.eks_version
		4  |   role_arn = aws_iam_role.eks_cluster_role.arn 
		5  | 
		6  |   vpc_config {
		7  |     endpoint_private_access = false
		8  |     endpoint_public_access  = true
		9  |     subnet_ids = aws_subnet.private[*].id
		10 |   }
		11 | 
		12 | 
		13 |   access_config {
		14 |     authentication_mode                         = "API"
		15 |     bootstrap_cluster_creator_admin_permissions = true
		16 |   }
		17 | 
		18 |   depends_on = [
		19 |     aws_iam_role_policy_attachment.eks_cluster_policy
		20 |   ]
		21 | }

Check: CKV_AWS_337: "Ensure SSM parameters are using KMS CMK"
	FAILED for resource: aws_ssm_parameter.db_creds
	File: /paramter_store.tf:1-10
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-337

		1  | resource "aws_ssm_parameter" "db_creds" {
		2  |   name      = "prod/mongo/credentials"
		3  |   type      = "SecureString"
		4  |   overwrite = true
		5  |   value     = jsonencode({
		6  |     MONGO_INITDB_ROOT_USERNAME   = local.secrets.MONGO_INITDB_ROOT_USERNAME
		7  |     MONGO_INITDB_ROOT_PASSWORD   = local.secrets.MONGO_INITDB_ROOT_PASSWORD
		8  |     MONGO_INITDB_DATABASE        = local.secrets.MONGO_INITDB_DATABASE
		9  |   })
		10 | }

Check: CKV_AWS_337: "Ensure SSM parameters are using KMS CMK"
	FAILED for resource: aws_ssm_parameter.back_creds
	File: /paramter_store.tf:12-22
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-337

		12 | resource "aws_ssm_parameter" "back_creds" {
		13 |   name      = "prod/back/credentials"
		14 |   type      = "SecureString"
		15 |   overwrite = true
		16 |   value     = jsonencode({
		17 |     MONGO_URI    = "mongodb://${local.secrets.MONGO_INITDB_ROOT_USERNAME}:${local.secrets.MONGO_INITDB_ROOT_PASSWORD}@db-svc:27017/${local.secrets.MONGO_INITDB_DATABASE}?authSource=admin"
		18 |     PAYPAL_CLIENT_ID      = local.secrets.PAYPAL_CLIENT_ID
		19 |     PAYPAL_APP_SECRET      = local.secrets.PAYPAL_APP_SECRET
		20 |     JWT_SECRET  = local.secrets.JWT_SECRET
		21 |   })
		22 | }
Check: CKV_AWS_130: "Ensure VPC subnets do not assign public IP by default"
	FAILED for resource: aws_subnet.public[0]
	File: /vpc.tf:11-24
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default

		11 | resource "aws_subnet" "public" {
		12 |   count = length(var.public_subnets)
		13 | 
		14 |   vpc_id                  = aws_vpc.main.id
		15 |   cidr_block              = var.public_subnets[count.index]
		16 |   availability_zone       = element(data.aws_availability_zones.available.names, count.index)
		17 |   map_public_ip_on_launch = true
		18 | 
		19 |   tags = {
		20 |     Name                                        = "${var.cluster_name}-public-subnet-${count.index + 1}"
		21 |     "kubernetes.io/cluster/${var.cluster_name}" = "shared"
		22 |     "kubernetes.io/role/elb"                    = "1" # For public/internet-facing load balancers
		23 |   }
		24 | }

Check: CKV_AWS_130: "Ensure VPC subnets do not assign public IP by default"
	FAILED for resource: aws_subnet.public[1]
	File: /vpc.tf:11-24
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default

		11 | resource "aws_subnet" "public" {
		12 |   count = length(var.public_subnets)
		13 | 
		14 |   vpc_id                  = aws_vpc.main.id
		15 |   cidr_block              = var.public_subnets[count.index]
		16 |   availability_zone       = element(data.aws_availability_zones.available.names, count.index)
		17 |   map_public_ip_on_launch = true
		18 | 
		19 |   tags = {
		20 |     Name                                        = "${var.cluster_name}-public-subnet-${count.index + 1}"
		21 |     "kubernetes.io/cluster/${var.cluster_name}" = "shared"
		22 |     "kubernetes.io/role/elb"                    = "1" # For public/internet-facing load balancers
		23 |   }
		24 | }

Check: CKV2_AWS_12: "Ensure the default security group of every VPC restricts all traffic"
	FAILED for resource: aws_vpc.main
	File: /vpc.tf:1-9
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-4

		1 | resource "aws_vpc" "main" {
		2 |   cidr_block           = var.vpc_cidr
		3 |   # enable_dns_hostnames = true
		4 |   # enable_dns_support   = true
		5 | 
		6 |   tags = {
		7 |     Name = "${var.cluster_name}-vpc"
		8 |   }
		9 | }

Check: CKV2_AWS_11: "Ensure VPC flow logging is enabled in all VPCs"
	FAILED for resource: aws_vpc.main
	File: /vpc.tf:1-9
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-9-enable-vpc-flow-logging

		1 | resource "aws_vpc" "main" {
		2 |   cidr_block           = var.vpc_cidr
		3 |   # enable_dns_hostnames = true
		4 |   # enable_dns_support   = true
		5 | 
		6 |   tags = {
		7 |     Name = "${var.cluster_name}-vpc"
		8 |   }
		9 | }

Check: CKV2_AWS_38: "Ensure Domain Name System Security Extensions (DNSSEC) signing is enabled for Amazon Route 53 public hosted zones"
	FAILED for resource: aws_route53_zone.admin_panel
	File: /route53.tf:1-7
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-2-38

		1 | resource "aws_route53_zone" "admin_panel" {
		2 |   name = var.panel_domain
		3 |   
		4 |   tags = {
		5 |     Name = "admin panel Domain"
		6 |   }
		7 | }

Check: CKV2_AWS_38: "Ensure Domain Name System Security Extensions (DNSSEC) signing is enabled for Amazon Route 53 public hosted zones"
	FAILED for resource: aws_route53_zone.users_domain
	File: /route53.tf:10-16
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-2-38

		10 | resource "aws_route53_zone" "users_domain" {
		11 |   name = var.users_domain
		12 |   
		13 |   tags = {
		14 |     Name = "users domain Domain"
		15 |   }
		16 | }

Check: CKV2_AWS_39: "Ensure Domain Name System (DNS) query logging is enabled for Amazon Route 53 hosted zones"
	FAILED for resource: aws_route53_zone.admin_panel
	File: /route53.tf:1-7
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-39

		1 | resource "aws_route53_zone" "admin_panel" {
		2 |   name = var.panel_domain
		3 |   
		4 |   tags = {
		5 |     Name = "admin panel Domain"
		6 |   }
		7 | }

Check: CKV2_AWS_39: "Ensure Domain Name System (DNS) query logging is enabled for Amazon Route 53 hosted zones"
	FAILED for resource: aws_route53_zone.users_domain
	File: /route53.tf:10-16
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-39

		10 | resource "aws_route53_zone" "users_domain" {
		11 |   name = var.users_domain
		12 |   
		13 |   tags = {
		14 |     Name = "users domain Domain"
		15 |   }
		16 | }

